<!doctype html>
<html lang="cs">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, viewport-fit=cover"
    />
    <title>Michal Klimek VaF'i'T ChatGPT</title>

    <style>
      html,
      body {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
        overflow: hidden;
        background: radial-gradient(circle at top, #050815, #020208);
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
          sans-serif;
        color: #f5f5f5;
      }

      /* CEL√ù R√ÅMEC KOLEM KOULE */
      .world-shell {
        position: fixed;
        inset: 0;
        display: flex;
        flex-direction: column;
        padding: 10px 10px 14px;
        box-sizing: border-box;
        gap: 8px;
      }

      .world-header {
        flex: 0 0 auto;
        display: flex;
        align-items: center;
        justify-content: space-between;
        font-size: 11px;
        opacity: 0.8;
      }

      .world-header-title {
        font-weight: 600;
        letter-spacing: 0.12em;
        text-transform: uppercase;
      }

      .world-header-right {
        font-size: 10px;
        opacity: 0.75;
      }

      .world-main {
        flex: 1 1 auto;
        display: flex;
        flex-direction: column;
        gap: 8px;
        min-height: 0;
      }

      /* STAGE S KOUL√ç */
      .stage-wrap {
        flex: 1 1 auto;
        display: flex;
        align-items: center;
        justify-content: center;
        min-height: 0;
      }

      .stage {
        position: relative;
        width: min(520px, 82vw);
        height: min(520px, 82vw);
        border-radius: 32px;
        box-shadow: 0 40px 90px rgba(0, 0, 0, 0.85);
        background: radial-gradient(circle at top, #06091a, #020208);
        border: 1px solid rgba(255, 255, 255, 0.04);
        overflow: hidden;
      }

      #globe-canvas {
        position: absolute;
        inset: 0;
        margin: auto;
        width: 100%;
        height: 100%;
        display: block;
      }

      .hud {
        position: absolute;
        left: 18px;
        bottom: 14px;
        font-size: 10px;
        opacity: 0.7;
        pointer-events: none;
      }

      .hud-right {
        position: absolute;
        right: 18px;
        top: 14px;
        font-size: 10px;
        opacity: 0.7;
        pointer-events: none;
      }

      /* SPODN√ç PLATFORMa ‚Äì DOK PRO OBJEKTY / APPKY */
      .world-dock {
        flex: 0 0 auto;
        border-radius: 18px;
        padding: 8px 10px 9px;
        background: radial-gradient(circle at top, #080910, #020208);
        border: 1px solid rgba(255, 255, 255, 0.06);
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.85);
        font-size: 11px;
        display: flex;
        flex-direction: column;
        gap: 6px;
      }

      .world-dock-header {
        display: flex;
        justify-content: space-between;
        align-items: baseline;
        gap: 8px;
      }

      .world-dock-title {
        font-size: 11px;
        font-weight: 600;
      }

      .world-dock-sub {
        font-size: 10px;
        opacity: 0.7;
      }

      .world-dock-grid {
        display: flex;
        flex-wrap: nowrap;
        overflow-x: auto;
        gap: 6px;
        padding-bottom: 2px;
      }

      .world-dock-item {
        flex: 0 0 auto;
        min-width: 80px;
        max-width: 130px;
        padding: 6px 8px;
        border-radius: 12px;
        border: 1px solid rgba(255, 255, 255, 0.08);
        background: radial-gradient(circle at top, #151829, #050509);
        font-size: 10px;
        line-height: 1.3;
        cursor: pointer;
        display: flex;
        flex-direction: column;
        gap: 3px;
      }

      .world-dock-item-label {
        font-weight: 600;
        font-size: 10px;
      }

      .world-dock-item-tag {
        font-size: 9px;
        opacity: 0.75;
      }

      .world-dock-empty {
        font-size: 10px;
        opacity: 0.6;
      }

      .world-dock-item:active {
        transform: translateY(1px) scale(0.99);
      }

      @media (max-width: 480px) {
        .world-dock {
          padding-inline: 8px;
        }
      }
    </style>
  </head>

  <body>
    <div class="world-shell">
      <header class="world-header">
        <div class="world-header-title">Vivere atque FruiT ‚Ä¢ Platforma</div>
        <div class="world-header-right">Michal Klimek √ó VaF'i'T √ó ChatGPT</div>
      </header>

      <main class="world-main">
        <!-- STAGE S 3D KUL√ç -->
        <div class="stage-wrap">
          <div class="stage">
            <canvas id="globe-canvas"></canvas>

            <div class="hud">üåÄ ot√°ƒçej kouli prstem / my≈°√≠</div>
            <div class="hud-right">v0.3 ‚Ä¢ koule + platforma</div>
          </div>
        </div>

        <!-- SPODN√ç PLATFORMa PRO SVƒöTY / APPKY -->
        <section class="world-dock">
          <div class="world-dock-header">
            <div class="world-dock-title">Z√°kladn√≠ platforma Vivere atque FruiT</div>
            <div class="world-dock-sub">
              Tady budeme p≈ôid√°vat svƒõty a aplikace z repozit√°≈ôe.
            </div>
          </div>

          <div id="world-dock-grid" class="world-dock-grid">
            <!-- sem se budou renderovat polo≈æky z WORLD_PLATFORM -->
          </div>
        </section>
      </main>
    </div>

    <script>
      const canvas = document.getElementById("globe-canvas");
      const ctx = canvas.getContext("2d");

      let width = 0;
      let height = 0;
      let cx = 0;
      let cy = 0;
      let radius = 0;
      let dpr = window.devicePixelRatio || 1;

      function resize() {
        const rect = canvas.getBoundingClientRect();
        width = rect.width;
        height = rect.height;
        cx = width / 2;
        cy = height / 2;
        radius = Math.min(width, height) * 0.33;

        canvas.width = width * dpr;
        canvas.height = height * dpr;
        ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
      }

      resize();
      window.addEventListener("resize", resize);

      // stav ot√°ƒçen√≠
      let rotY = 0.5;
      let rotX = -0.3;
      let drag = false;
      let lastX = 0;
      let lastY = 0;

      function project(x, y, z) {
        // rotace kolem osy X
        let y1 = y * Math.cos(rotX) - z * Math.sin(rotX);
        let z1 = y * Math.sin(rotX) + z * Math.cos(rotX);

        // rotace kolem osy Y
        let x2 = x * Math.cos(rotY) + z1 * Math.sin(rotY);
        let z2 = -x * Math.sin(rotY) + z1 * Math.cos(rotY);

        const scale = radius * 0.9;
        return {
          x: cx + x2 * scale,
          y: cy + y1 * scale,
          z: z2,
        };
      }

      function drawGlobe() {
        ctx.clearRect(0, 0, width, height);

        // jemn√Ω podklad
        const g = ctx.createRadialGradient(
          cx,
          cy - radius * 0.4,
          radius * 0.2,
          cx,
          cy,
          radius * 1.4
        );
        g.addColorStop(0, "rgba(255, 200, 150, 0.18)");
        g.addColorStop(1, "rgba(0, 0, 0, 0)");
        ctx.fillStyle = g;
        ctx.fillRect(0, 0, width, height);

        // st√≠nov√° koule
        ctx.beginPath();
        ctx.arc(cx, cy, radius * 1.02, 0, Math.PI * 2);
        ctx.fillStyle = "rgba(0,0,0,0.75)";
        ctx.fill();

        // z√°kladn√≠ tƒõlo koule
        ctx.beginPath();
        ctx.arc(cx, cy, radius, 0, Math.PI * 2);
        const globeGrad = ctx.createRadialGradient(
          cx - radius * 0.3,
          cy - radius * 0.4,
          radius * 0.3,
          cx,
          cy + radius * 0.4,
          radius * 1.1
        );
        globeGrad.addColorStop(0, "#2d1d0f");
        globeGrad.addColorStop(0.5, "#1b1012");
        globeGrad.addColorStop(1, "#050308");
        ctx.fillStyle = globeGrad;
        ctx.fill();

        // zlat√Ω okraj
        ctx.strokeStyle = "rgba(255, 197, 120, 0.9)";
        ctx.lineWidth = 1.4;
        ctx.shadowColor = "rgba(255, 197, 120, 0.9)";
        ctx.shadowBlur = 10;
        ctx.beginPath();
        ctx.arc(cx, cy, radius, 0, Math.PI * 2);
        ctx.stroke();
        ctx.shadowBlur = 0;

        // m≈ô√≠≈æka ‚Äì zlat√© linky
        ctx.lineWidth = 0.9;
        ctx.strokeStyle = "rgba(255, 210, 140, 0.9)";

        // pod√©ln√© kru≈ænice (meridi√°ny)
        const meridians = 12;
        for (let i = 0; i < meridians; i++) {
          const lon = (i / meridians) * Math.PI * 2;
          ctx.beginPath();
          let started = false;
          for (let s = 0; s <= 60; s++) {
            const t = (s / 60) * Math.PI - Math.PI / 2;
            const x = Math.cos(t) * Math.cos(lon);
            const y = Math.sin(t);
            const z = Math.cos(t) * Math.sin(lon);
            const p = project(x, y, z);
            if (p.z >= 0) {
              if (!started) {
                ctx.moveTo(p.x, p.y);
                started = true;
              } else {
                ctx.lineTo(p.x, p.y);
              }
            }
          }
          ctx.stroke();
        }

        // rovnobƒõ≈æky (paralely)
        const parallels = 8;
        for (let j = 1; j < parallels; j++) {
          const lat = (j / parallels) * Math.PI - Math.PI / 2;
          ctx.beginPath();
          let started = false;
          for (let s = 0; s <= 90; s++) {
            const lon = (s / 90) * Math.PI * 2;
            const x = Math.cos(lat) * Math.cos(lon);
            const y = Math.sin(lat);
            const z = Math.cos(lat) * Math.sin(lon);
            const p = project(x, y, z);
            if (p.z >= 0) {
              if (!started) {
                ctx.moveTo(p.x, p.y);
                started = true;
              } else {
                ctx.lineTo(p.x, p.y);
              }
            }
          }
          ctx.stroke();
        }

        // === text uvnit≈ô koule (ty a j√° + logo) ===
        ctx.save();
        ctx.translate(cx, cy);
        ctx.rotate(rotY * 0.15);

        ctx.font = "700 15px system-ui";
        ctx.fillStyle = "rgba(255, 220, 150, 0.95)";
        ctx.textAlign = "center";
        ctx.textBaseline = "middle";
        ctx.shadowColor = "rgba(255, 200, 120, 0.9)";
        ctx.shadowBlur = 14;

        ctx.fillText(
          "{*(¬∞.).)// Vivere atque Fru'ii'T \\\\(.(.¬∞)*]",
          0,
          0
        );

        ctx.restore();
      }

      // plynul√© ot√°ƒçen√≠ podle ƒçasu
      let lastTime = 0;

      function loop(timestamp) {
        if (!timestamp) timestamp = 0;
        const dt = (timestamp - lastTime) / 1000;
        lastTime = timestamp;

        rotY += 0.4 * dt;
        drawGlobe();

        requestAnimationFrame(loop);
      }

      requestAnimationFrame(loop);

      // ovl√°d√°n√≠ prstem / my≈°√≠
      function pointerDown(e) {
        drag = true;
        const touch = e.touches ? e.touches[0] : e;
        lastX = touch.clientX;
        lastY = touch.clientY;
      }

      function pointerMove(e) {
        if (!drag) return;
        const touch = e.touches ? e.touches[0] : e;
        const x = touch.clientX;
        const y = touch.clientY;
        const dx = x - lastX;
        const dy = y - lastY;
        lastX = x;
        lastY = y;

        rotY += dx * 0.004;
        rotX += dy * 0.004;
        rotX = Math.max(-Math.PI / 2 + 0.2, Math.min(Math.PI / 2 - 0.2, rotX));
      }

      function pointerUp() {
        drag = false;
      }

      canvas.addEventListener("mousedown", pointerDown);
      window.addEventListener("mousemove", pointerMove);
      window.addEventListener("mouseup", pointerUp);

      canvas.addEventListener("touchstart", pointerDown, { passive: true });
      window.addEventListener("touchmove", pointerMove, { passive: true });
      window.addEventListener("touchend", pointerUp);

      // ====== PLATFORMa ‚Äì P≈òIPRAVEN√â M√çSTO PRO SVƒöTY / APPKY ======
      const dockGrid = document.getElementById("world-dock-grid");
      const worldSlots = [];

      function renderDock() {
        dockGrid.innerHTML = "";
        if (!worldSlots.length) {
          const empty = document.createElement("div");
          empty.className = "world-dock-empty";
          empty.textContent =
            "Zat√≠m ≈æ√°dn√© p≈ôipojen√© svƒõty. Brzy sem napoj√≠me Revia, VaF'i'T, MapWorld a dal≈°√≠.";
          dockGrid.appendChild(empty);
          return;
        }

        worldSlots.forEach((slot) => {
          const btn = document.createElement("button");
          btn.type = "button";
          btn.className = "world-dock-item";
          btn.innerHTML =
            '<div class="world-dock-item-label">' +
            (slot.label || "Svƒõt") +
            "</div>" +
            (slot.tag
              ? '<div class="world-dock-item-tag">' + slot.tag + "</div>"
              : "");
          if (slot.href) {
            btn.addEventListener("click", () => {
              window.location.href = slot.href;
            });
          }
          dockGrid.appendChild(btn);
        });
      }

      window.WORLD_PLATFORM = {
        addObject(slot) {
          worldSlots.push(slot);
          renderDock();
        },
      };

      // ZAT√çM NECH√ÅV√ÅM BEZ OBSAHU ‚Äì A≈Ω BUDE≈† CHT√çT, P≈òID√ÅME NAP≈ò.:
      // WORLD_PLATFORM.addObject({
      //   id: "vafit",
      //   label: "VaF'i'T Motor",
      //   tag: "chat + p√≠smenka",
      //   href: "./VaFiT/index.html"
      // });

      renderDock();
    </script>
  </body>
</html>
