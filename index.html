<!doctype html>
<html lang="cs">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Vivere atque FruiT</title>
    <meta name="theme-color" content="#000000" />
    <link rel="manifest" href="./manifest.json" />
    <link rel="stylesheet" href="./style.css" />
    <style>
      /* syst√©mov√© okno */
      #systemMenu {
        position: fixed;
        bottom: 85px;
        right: 14px;
        background: rgba(5, 8, 12, 0.9);
        border: 1px solid rgba(130,155,180,0.25);
        border-radius: 16px;
        padding: 14px 12px 10px;
        color: #e8f5ff;
        backdrop-filter: blur(14px);
        min-width: 240px;
        max-height: 60vh;
        overflow-y: auto;
        box-shadow: 0 8px 25px rgba(0,0,0,.35);
        z-index: 200;
      }
      #systemMenu.hidden { display: none; }
      #systemMenu h3 {
        margin: 0 0 8px;
        font-size: .78rem;
        opacity: .8;
        letter-spacing: .04em;
      }
      .sys-app {
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 6px;
        margin-bottom: 6px;
      }
      .sys-app-name { font-size: .72rem; }
      .sys-app-btn {
        background: rgba(112,194,227,.12);
        border: 1px solid rgba(112,194,227,.35);
        color: #e8f5ff;
        border-radius: 9px;
        font-size: .6rem;
        padding: 3px 8px 4px;
      }
      .system-open-btn { margin-top: 12px; }
    </style>
  </head>
  <body>
    <!-- TOP -->
    <div class="topbar">
      <div class="brand-block">
        <div class="brand-mini">ƒ¨‚Äô‚ô° ‚Üì</div>
        <div class="brand-title">Vivere atque FruiT</div>
        <div class="role-badge" id="core-status">üß† Hlavoun syst√©m</div>
      </div>
      <div class="coins">
        <div class="coin-icon">üí∞</div>
        <div class="coin-txt">
          <div>0</div>
          <div class="coin-ver">v0.31 ‚Ä¢ ≈æiv√Ω z√°klad</div>
        </div>
      </div>
    </div>

    <!-- ST≈òED / REVIA -->
    <div class="revia-panel">
      <div class="revia-head">
        <div class="revia-title">Revia</div>
        <a class="revia-link" href="javascript:void(0)" onclick="openApp('./Revia/')">Otev≈ô√≠t Revii ‚Üí</a>
      </div>
      <div class="rules">
        <div>Pravidlo 1 : P≈ô√°telstv√≠</div>
        <div>Pravidlo 2 : Vivere atque frui</div>
      </div>
      <div class="pulse-line">
        <span class="pulse-dot"></span>
        <span>‚ù§Ô∏è svƒõt: puls <span id="pulseTime">00:00:00</span></span>
      </div>
      <div class="center-orbit">
        <div class="vaft-core">Vivere<br>atque FruiT</div>
        <div class="orbit-node node-glyph">Glyph</div>
        <div class="orbit-node node-ai">AI (Orbit)</div>
        <div class="orbit-node node-world">World (Core)</div>
      </div>
    </div>

    <!-- Z√ÅLO≈ΩKY -->
    <div class="tabs">
      <button class="tab-btn active" data-tab="heroes">Hrdinov√©</button>
      <button class="tab-btn" data-tab="space">Meziprostor</button>
      <button class="tab-btn" data-tab="system">Syst√©m</button>
      <button class="tab-btn" data-tab="nodes">S√≠≈•</button>
    </div>

    <!-- PANEL HRDINOV√â -->
    <div class="panel active" id="panel-heroes">
      <div class="panel-title">Hrdinov√©</div>
      <label class="label-sm">Jm√©no hrdiny</label>
      <input id="hero-name" class="hero-input" placeholder="nap≈ô. Piko, Orbit, M√≠za‚Ä¶" />
      <label class="label-sm">T√Ωm</label>
      <select id="hero-team" class="hero-select">
        <option>Human (Piko)</option>
        <option>AI (Orbit)</option>
        <option>Glyph</option>
        <option>World (Core)</option>
      </select>
      <button class="btn-primary" onclick="saveHero()">+ P≈ôidat hrdinu</button>
      <div id="selectedVafit"></div>
      <div id="heroesList" class="list-sm"></div>
    </div>

    <!-- PANEL MEZIPROSTOR -->
    <div class="panel" id="panel-space">
      <div class="panel-title">Meziprostor (Hlavoun)</div>
      <div id="hlavoun-chat"></div>
      <div class="chat-row">
        <input id="hlavoun-input" placeholder="napi≈° Hlavounovi...">
        <button onclick="sendToHlavoun()">Poslat</button>
      </div>
      <div class="quick-row">
        <button onclick="sendQuickToHlavoun('p≈ô√≠bƒõh pro vybran√©ho vafita')">üí° P≈ô√≠bƒõh</button>
        <button onclick="sendQuickToHlavoun('gps ulo≈æit')">üìç GPS</button>
        <button onclick="sendQuickToHlavoun('zkontroluj repo')">üîé Repo</button>
        <button onclick="sendQuickToHlavoun('batole svƒõt')">üçº Batole svƒõt</button>
      </div>
    </div>

    <!-- PANEL SYST√âM -->
    <div class="panel" id="panel-system">
      <div class="panel-title">Syst√©m / appky</div>
      <p style="opacity:.65;font-size:.7rem;">V≈°echno jsme schovali do jednoho okna, a≈• je po≈ô√°dek üëá</p>
      <button class="btn-primary system-open-btn" onclick="toggleSystemMenu()">Otev≈ô√≠t syst√©mov√© appky</button>
    </div>

    <!-- PANEL S√ç≈§ -->
    <div class="panel" id="panel-nodes">
      <div class="panel-title">S√≠≈• uzl≈Ø</div>
      <p style="opacity:.6;font-size:.7rem;">Tady se zobrazuj√≠ v≈°echny ≈æiv√© ƒçtvereƒçky napojen√© na Vivere atque FruiT.</p>
      <div id="vaft-nodes" style="display:flex;flex-wrap:wrap;gap:8px;margin-top:10px;"></div>
      <div id="vaft-nodes-outer"></div>
      <div id="vaft-nodes-mirror"></div>
      <div id="vaft-nodes-origin"></div>
    </div>

    <!-- MENU APP -->
    <div id="systemMenu" class="hidden">
      <h3>VAFT ‚Äì tvoje appky</h3>
      <div class="sys-app"><div class="sys-app-name">Vivere (hlavn√≠)</div><button class="sys-app-btn" onclick="openApp('./')">Otev≈ô√≠t</button></div>
      <div class="sys-app"><div class="sys-app-name">Braska-Hlava</div><button class="sys-app-btn" onclick="openApp('./Braska-Hlava/')">Otev≈ô√≠t</button></div>
      <div class="sys-app"><div class="sys-app-name">Hlavoun</div><button class="sys-app-btn" onclick="openApp('./Hlavoun/')">Otev≈ô√≠t</button></div>
      <div class="sys-app"><div class="sys-app-name">Meziprostor-Core</div><button class="sys-app-btn" onclick="openApp('./Meziprostor-Core/')">Otev≈ô√≠t</button></div>
      <div class="sys-app"><div class="sys-app-name">VAFT-Network</div><button class="sys-app-btn" onclick="openApp('./VAFT-Network/')">Otev≈ô√≠t</button></div>
    <div class="sys-app">
  <div class="sys-app-name">Vivere (lite)</div>
  <button class="sys-app-btn" onclick="openApp('./lite/')">Otev≈ô√≠t</button>
    </div>

    <div class="panel" id="panel-vent" style="display:none;">
  <div class="panel-title">Ventil / v√Ωstup s√≠tƒõ</div>
  <div class="vent-controls" style="display:flex;gap:8px;align-items:center;margin-bottom:8px;">
    <select id="vent-filter-agent" style="min-width:120px;">
      <option value="">‚Äî V≈°echny agenty ‚Äî</option>
      <option value="Hlavoun">Hlavoun</option>
      <option value="Viri">Viri</option>
      <option value="Pikos">Pikos</option>
      <option value="Vivere">Vivere</option>
      <option value="?">?</option>
    </select>
    <select id="vent-filter-type" style="min-width:120px;">
      <option value="">‚Äî V≈°echny typy ‚Äî</option>
      <option value="signal">signal</option>
      <option value="heartbeat">heartbeat</option>
      <option value="diagnostic">diagnostic</option>
      <option value="output">output</option>
      <option value="custom">custom</option>
    </select>
    <button id="vent-clear" class="btn-small">Vyƒçistit</button>
    <button id="vent-export" class="btn-small">Export JSON</button>
  </div>
  <div id="vent-summary" style="opacity:.8;font-size:.8rem;margin-bottom:8px;"></div>
  <div id="vent-feed" style="max-height:48vh;overflow:auto;padding:6px;border-radius:10px;background:rgba(10,12,15,.45);border:1px solid rgba(255,255,255,.03)"></div>
</div>
    
    <!-- Z√ÅKLADN√ç SCRIPTY -->
    <script>
      function openApp(url){ window.location.href = url; }
      function tick(){
        const el = document.getElementById('pulseTime');
        if(el) el.textContent = new Date().toLocaleTimeString('cs-CZ',{hour:'2-digit',minute:'2-digit',second:'2-digit'});
      }
      function showTab(which){
        document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('active'));
        document.querySelectorAll('.panel').forEach(p=>p.classList.remove('active'));
        const btn=document.querySelector('[data-tab="'+which+'"]');
        const pan=document.getElementById('panel-'+which);
        if(btn) btn.classList.add('active');
        if(pan) pan.classList.add('active');
        if(which!=='system'){const m=document.getElementById('systemMenu');if(m)m.classList.add('hidden');}
      }
      function toggleSystemMenu(){document.getElementById('systemMenu').classList.toggle('hidden');}
      function saveHero(){
        const name=document.getElementById('hero-name').value.trim();
        const team=document.getElementById('hero-team').value;
        if(!name)return;
        const heroes=JSON.parse(localStorage.getItem('VAFT_HEROES')||'[]');
        heroes.push({name,team,ts:Date.now()});
        localStorage.setItem('VAFT_HEROES',JSON.stringify(heroes));
        document.getElementById('hero-name').value='';
        renderHeroes();
      }
      function renderHeroes(){
        const heroes=JSON.parse(localStorage.getItem('VAFT_HEROES')||'[]');
        const box=document.getElementById('heroesList');
        box.innerHTML=heroes.length?heroes.map(h=>'‚Ä¢ '+h.name+' ('+h.team+')').join('<br>'):'Zat√≠m nem√°≈° ulo≈æen√© hrdiny.';
      }
      document.addEventListener('DOMContentLoaded',()=>{
        tick();setInterval(tick,1000);
        document.querySelectorAll('.tab-btn').forEach(btn=>btn.addEventListener('click',()=>showTab(btn.dataset.tab)));
        showTab('heroes');renderHeroes();
      });
    </script>

       <!-- tady je mozek -->
    <script src="./app.js"></script>
    <script src="./hlavoun.js"></script>
    <script src="./viri.js"></script>
    <script src="./pikos.js"></script>
    <script src="./agents.js"></script>
    <script src="./agents_v3.js"></script>
    <script src="./vaft.bus.js"></script>
<script src="./vaft.agents.js"></script>
<script src="./vaft.brains.js"></script>  <!-- ‚Üê TADY NOV√â -->
<script>
  // naƒçti s√≠≈• bezpeƒçnƒõ ...
</script>
    <script>
  // naƒçti s√≠≈• bezpeƒçnƒõ jen kdy≈æ otev≈ôe user Meziprostor nebo S√≠≈•
  function loadNetworkCore() {
    if (window.VAFT && window.VAFT.network && window.VAFT.network.status && window.VAFT.network.status().started) return;
    const s = document.createElement('script');
    s.src = './vaft.network.core.js';
    s.onload = () => console.log('VAFT network core loaded');
    s.onerror = () => console.warn('VAFT network core failed to load');
    document.body.appendChild(s);
  }

  // p≈ôepni showTab (m√°≈° ho v indexu) aby volal loadNetworkCore
  const _origShowTab = window.showTab || function(){};
  window.showTab = function(t) {
    _origShowTab(t);
    if (t === 'nodes' || t === 'space') loadNetworkCore();
  };
</script>
    <script src="./vaft.engine.js"></script>
    <script src="./vaft.ascend.js"></script>
<script src="./vaft.diagnostics.js"></script>
    
    <!-- s√≠≈• naƒçti jen pokud soubor existuje -->
    <script>
      (function () {
        var s = document.createElement('script');
        s.src = './vaft.network.js';
        s.onload = function () {
          console.log('VAFT network p≈ôipojena');
        };
        s.onerror = function () {
          console.warn('VAFT network.js se nenaƒçetl ‚Äì jedu bez s√≠tƒõ');
        };
        document.body.appendChild(s);
      })();
    </script>
  </body>
</html>
