<!doctype html>
<html lang="cs">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Vivere atque FruiT</title>
  <meta name="theme-color" content="#000000" />
  <style>
    :root {
      color-scheme: dark;
      --bg: #000;
      --fg: #f5f5f5;
      --accent: #ff3b30;
      --accent-soft: rgba(255,59,48,.16);
      --card-bg: rgba(255,255,255,.04);
      --border: rgba(255,255,255,.14);
      --ok: #30d158;
      --err: #ff453a;
      --warn: #ffd60a;
    }

    * { box-sizing: border-box; }

    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      background: radial-gradient(circle at top, #050505 0, #000 45%, #000 100%);
      color: var(--fg);
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text",
                   "Segoe UI", Roboto, sans-serif;
    }

    body {
      display: flex;
      justify-content: center;
      align-items: stretch;
    }

    .app {
      width: 100%;
      max-width: 520px;
      padding: 16px 14px 26px;
      display: flex;
      flex-direction: column;
      gap: 14px;
    }

    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 14px;
      border-radius: 18px;
      background: linear-gradient(135deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
      border: 1px solid var(--border);
      backdrop-filter: blur(14px);
    }

    header .title {
      font-weight: 650;
      letter-spacing: .03em;
      font-size: 16px;
    }

    header .subtitle {
      font-size: 11px;
      opacity: .78;
      text-align: right;
    }

    .hero {
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 12px 10px 6px;
    }

    .hero img {
      max-width: 78vw;
      max-height: 54vh;
      height: auto;
      display: block;
      border-radius: 26px;
    }

    main {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    section.card {
      border-radius: 20px;
      border: 1px solid var(--border);
      background: var(--card-bg);
      padding: 12px 12px 10px;
      backdrop-filter: blur(10px);
    }

    .card h2 {
      margin: 0 0 8px;
      font-size: 14px;
      font-weight: 600;
      letter-spacing: .06em;
      text-transform: uppercase;
      opacity: .9;
    }

    .module-list {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(130px, 1fr));
      gap: 6px;
    }

    .module-pill {
      padding: 6px 8px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.3);
      font-size: 11px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 4px;
      min-height: 30px;
    }

    .module-pill span.name {
      flex: 1;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .badge {
      font-size: 10px;
      padding: 2px 6px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.22);
      background: rgba(255,255,255,.05);
    }

    .badge.ok    { border-color: var(--ok);   color: var(--ok); }
    .badge.err   { border-color: var(--err);  color: var(--err); }
    .badge.load  { border-color: var(--warn); color: var(--warn); }

    .world-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px,1fr));
      gap: 6px;
    }

    .world-tile {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 9px 10px;
      border-radius: 14px;
      border: 1px solid var(--border);
      background: rgba(0,0,0,.5);
      font-size: 12px;
      text-decoration: none;
      color: var(--fg);
    }

    .world-tile span {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .world-tile:active {
      transform: scale(.97);
      background: rgba(255,255,255,.06);
    }

    #console-log {
      max-height: 120px;
      overflow: auto;
      font-family: "SF Mono", Menlo, Consolas, monospace;
      font-size: 11px;
      line-height: 1.35;
      padding: 6px 6px 4px;
      border-radius: 10px;
      background: #050505;
      border: 1px solid rgba(255,255,255,.18);
    }

    #console-log div {
      margin-bottom: 2px;
      white-space: nowrap;
    }

    #reload-modules {
      margin-top: 8px;
      width: 100%;
      border-radius: 12px;
      border: 1px solid var(--accent);
      background: var(--accent-soft);
      color: #fff;
      padding: 7px 0;
      font-size: 12px;
    }

    #reload-modules:active {
      transform: scale(.98);
      filter: brightness(1.1);
    }

    footer {
      margin-top: 6px;
      font-size: 10px;
      opacity: .7;
      text-align: center;
    }

    .fab {
      position: fixed;
      right: 16px;
      bottom: 18px;
      display: inline-flex;
      align-items: center;
      gap: .45rem;
      padding: 9px 12px;
      border-radius: 16px;
      background: rgba(255,255,255,.07);
      color: #fff;
      border: 1px solid rgba(255,255,255,.22);
      text-decoration: none;
      font-size: 12px;
      backdrop-filter: blur(10px);
    }

    .fab:active { transform: scale(.97); }

    @media (max-width: 400px) {
      header { padding-inline: 10px; }
      .hero img { max-width: 86vw; }
    }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <div class="title">Vivere atque FruiT</div>
      <div class="subtitle">
        Michal &amp; Hlavoun<br/>
        ≈æiv√Ω syst√©m svƒõt≈Ø
      </div>
    </header>

    <div class="hero">
      <!-- n√°≈° spoleƒçn√Ω obr√°zek -->
      <img src="./AFA0870E-F586-4406-8BAA-0A7944120AA3.png"
           alt="Vivere atque FruiT ‚Äì kluk s mobilem" loading="lazy" />
    </div>

    <main>
      <!-- SYST√âMOV√â MODULY -->
      <section class="card">
        <h2>Status syst√©mu</h2>
        <div class="module-list" id="system-modules"></div>
      </section>

      <!-- SVƒöTY A MINIAPKY -->
      <section class="card">
        <h2>Svƒõt Vivere atque FruiT</h2>
        <div class="world-grid">
          <!-- hlavn√≠ svƒõty/postavy -->
          <a class="world-tile" href="./Revia/"><span>Revia</span></a>
          <a class="world-tile" href="./VAFT-BearHead/"><span>BearHead</span></a>
          <a class="world-tile" href="./Michal-AI-Al-Klimek/"><span>Michal AI Al Klimek</span></a>
          <a class="world-tile" href="./VafiT-gallery/"><span>VafiT gallery</span></a>
          <a class="world-tile" href="./VAFT-LetterLab/"><span>LetterLab</span></a>
          <a class="world-tile" href="./VAFT-Lilies/"><span>Lilie</span></a>
          <a class="world-tile" href="./VAFT-MapWorld/"><span>MapWorld</span></a>
          <a class="world-tile" href="./VAFT-Network/"><span>VAFT Network</span></a>
          <a class="world-tile" href="./Braska-Hlava/"><span>Br√°≈°ka Hlava</span></a>
          <a class="world-tile" href="./Hlavoun/"><span>Hlavoun</span></a>
          <a class="world-tile" href="./Meziprostor-Core/"><span>Meziprostor Core</span></a>
          <a class="world-tile" href="./VAFT-GhostGirl/"><span>GhostGirl</span></a>
          <a class="world-tile" href="./VAFT-Doll/"><span>Doll</span></a>
          <a class="world-tile" href="./VAFT-Girls/"><span>Girls</span></a>
          <a class="world-tile" href="./VAFT-Jizva/"><span>Jizva</span></a>
          <a class="world-tile" href="./VAFT-Lady/"><span>Lady</span></a>
          <a class="world-tile" href="./VAFT-Game/"><span>Game (experiment)</span></a>
          <a class="world-tile" href="./3I-ATLAS/"><span>3I Atlas</span></a>
          <a class="world-tile" href="./guardian/"><span>Guardian</span></a>
          <a class="world-tile" href="./mapa/"><span>Mapa</span></a>
          <a class="world-tile" href="./mapa-3d/"><span>Mapa 3D</span></a>
          <a class="world-tile" href="./lite/"><span>Lite re≈æim</span></a>
        </div>
      </section>

      <!-- DIAGNOSTIKA -->
      <section class="card">
        <h2>Diagnostika modul≈Ø</h2>
        <div id="console-log"></div>
        <button id="reload-modules">Znovu naƒç√≠st moduly</button>
      </section>
    </main>

    <footer>
      Vivere atque FruiT ‚Ä¢ ≈æiv√Ω index v≈°ech svƒõt≈Ø ‚Ä¢ v0.3 (testovac√≠ j√°dro)
    </footer>
  </div>

  <!-- zkratka na samostatnou appku Chybo≈ærout-Oprav√°≈ô -->
  <a class="fab" href="./chybozrout-opravar/">
    üß© Chybo≈ærout
  </a>

  <script>
    // ---------- Pomocn√© logov√°n√≠ ----------
    const consoleBox = document.getElementById('console-log');

    function logLine(msg, type = 'info') {
      if (!consoleBox) return;
      const line = document.createElement('div');
      let prefix = '¬∑';
      let color = '#ccc';
      if (type === 'ok')   { prefix = '‚úì'; color = '#30d158'; }
      if (type === 'err')  { prefix = '‚úó'; color = '#ff453a'; }
      if (type === 'warn') { prefix = '!'; color = '#ffd60a'; }
      line.textContent = prefix + ' ' + msg;
      line.style.color = color;
      consoleBox.appendChild(line);
      consoleBox.scrollTop = consoleBox.scrollHeight;
    }

    // ---------- Definice syst√©mov√Ωch modul≈Ø ----------
    const MODULES = [
      { id: 'vaft-core',         file: './vaft-core.js',             label: 'VAFT Core' },
      { id: 'vaft-kernel',       file: './vaft.kernel.js',           label: 'Kernel' },
      { id: 'vaft-loader',       file: './vaft.loader.js',           label: 'Loader' },
      { id: 'vaft-network',      file: './vaft.network.js',          label: 'Network' },
      { id: 'vaft-core-net',     file: './vaft.core.network.js',     label: 'Core Network' },
      { id: 'vaft-hub',          file: './vaft.hub.js',              label: 'Hub' },
      { id: 'vaft-bus',          file: './vaft.bus.js',              label: 'Bus' },
      { id: 'vaft-nodes',        file: './vaft.nodes.js',            label: 'Nodes' },
      { id: 'vaft-autonodes',    file: './vaft.autonodes.js',        label: 'Autonodes' },
      { id: 'vaft-autonodes-l2', file: './vaft.autonodes.layer2.js', label: 'Autonodes L2' },
      { id: 'vaft-autonodes-l3', file: './vaft.autonodes.layer3.js', label: 'Autonodes L3' },
      { id: 'vaft-autonodes-or', file: './vaft.autonodes.origin.js', label: 'Autonodes Origin' },
      { id: 'vaft-brains',       file: './vaft.brains.js',           label: 'Brains' },
      { id: 'vaft-fuel',         file: './vaft.fuel.js',             label: 'Fuel' },
      { id: 'vaft-engine',       file: './vaft.engine.js',           label: 'Engine' },
      { id: 'vaft-heartbeat',    file: './vaft.heartbeat.js',        label: 'Heartbeat' },
      { id: 'vaft-glyphs',       file: './vaft.glyphs.js',           label: 'Glyphs' },
      { id: 'vaft-spell',        file: './vaft.spell.js',            label: 'Spell' },
      { id: 'vaft-vent',         file: './vaft.vent.js',             label: 'Vent' },
      { id: 'vaft-agents',       file: './vaft.agents.js',           label: 'Agents' },
      { id: 'vaft-apps',         file: './vaft.apps.js',             label: 'Apps' },
      { id: 'vaft-all',          file: './vaft.all.js',              label: 'All (bundle)' },
      { id: 'vaft-ascend',       file: './vaft.ascend.js',           label: 'Ascend' },
      { id: 'vaft-msg-shell',    file: './vaft.message.shell.js',    label: 'Message shell' },
      { id: 'vaft-diagnostics',  file: './vaft.diagnostics.js',      label: 'Diagnostics' },
      { id: 'vaft-guardian',     file: './vaft.guardian.client.js',  label: 'Guardian client' },
      { id: 'vaft-chyboz',       file: './vaft.chybozrout.js',       label: 'Chybo≈ærout modul' },
      { id: 'agents-root',       file: './agents.js',                label: 'Agents (root)' },
      { id: 'app-root',          file: './app.js',                   label: 'App (root)' },
      { id: 'center-root',       file: './center.js',                label: 'Center' },
      { id: 'engine-root',       file: './engine.js',                label: 'Engine (root)' },
      { id: 'hlavoun-root',      file: './hlavoun.js',               label: 'Hlavoun' },
      { id: 'pikos-root',        file: './pikos.js',                 label: 'Piko≈°' },
      { id: 'viri-root',         file: './viri.js',                  label: 'Viri' }
    ];

    // ---------- UI pro moduly ----------
    const moduleListEl = document.getElementById('system-modules');
    const moduleState = {};

    function buildModuleList() {
      moduleListEl.innerHTML = '';
      MODULES.forEach(m => {
        const pill = document.createElement('div');
        pill.className = 'module-pill';
        pill.dataset.id = m.id;

        const name = document.createElement('span');
        name.className = 'name';
        name.textContent = m.label;

        const badge = document.createElement('span');
        badge.className = 'badge load';
        badge.textContent = 'ƒçek√°';

        pill.appendChild(name);
        pill.appendChild(badge);
        moduleListEl.appendChild(pill);

        moduleState[m.id] = { pill, badge };
      });
    }

    function setModuleStatus(id, status) {
      const entry = moduleState[id];
      if (!entry) return;
      entry.badge.classList.remove('ok', 'err', 'load');
      if (status === 'ok') {
        entry.badge.classList.add('ok');
        entry.badge.textContent = 'OK';
      } else if (status === 'err') {
        entry.badge.classList.add('err');
        entry.badge.textContent = 'chyba';
      } else if (status === 'load') {
        entry.badge.classList.add('load');
        entry.badge.textContent = '‚Ä¶';
      }
    }

    // ---------- Loader modul≈Ø ----------
    function loadScriptSequential(mod) {
      return new Promise((resolve) => {
        const s = document.createElement('script');
        const cacheBust = 'v=' + Date.now();
        s.src = mod.file + (mod.file.includes('?') ? '&' : '?') + cacheBust;
        s.onload = () => {
          setModuleStatus(mod.id, 'ok');
          logLine(mod.label + ' naƒçten', 'ok');
          resolve(true);
        };
        s.onerror = () => {
          setModuleStatus(mod.id, 'err');
          logLine('Nepoda≈ôilo se naƒç√≠st ' + mod.file, 'err');
          resolve(false);
        };
        setModuleStatus(mod.id, 'load');
        logLine('Naƒç√≠t√°m ' + mod.file + ' ‚Ä¶', 'warn');
        document.body.appendChild(s);
      });
    }

    async function loadAllModules() {
      consoleBox.innerHTML = '';
      logLine('Start sekvenƒçn√≠ho naƒç√≠t√°n√≠ modul≈Ø‚Ä¶', 'warn');
      for (const mod of MODULES) {
        // eslint-disable-next-line no-await-in-loop
        await loadScriptSequential(mod);
      }
      if (window.VAFT && typeof window.VAFT.boot === 'function') {
        try {
          window.VAFT.boot();
          logLine('VAFT.boot() probƒõhl', 'ok');
        } catch (e) {
          logLine('VAFT.boot() chyba: ' + e.message, 'err');
        }
      } else {
        logLine('VAFT.boot() nen√≠ k dispozici (zat√≠m?)', 'warn');
      }
    }

    // ---------- Init ----------
    document.addEventListener('DOMContentLoaded', () => {
      buildModuleList();
      loadAllModules();

      const btnReload = document.getElementById('reload-modules');
      btnReload.addEventListener('click', () => {
        loadAllModules();
      });

      // Service Worker (pokud existuje)
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('./service-worker.js')
          .then(() => logLine('Service worker registrov√°n', 'ok'))
          .catch(err => logLine('SW chyba: ' + err.message, 'err'));
      }
    });
  </script>
</body>
</html>
