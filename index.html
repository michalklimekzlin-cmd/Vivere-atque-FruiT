<!doctype html>
<html lang="cs">
  <head>
  <meta charset="utf-8" />
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Vivere atque FruiT</title>
  <meta name="theme-color" content="#000000" />
  <link rel="manifest" href="./manifest.json" />
  <link rel="stylesheet" href="./style.css" />
</head>
  <body>
    <!-- TOP -->
    <div class="topbar">
      <div class="brand-block">
        <div class="brand-mini">ƒ¨‚Äô‚ô° ‚Üì</div>
        <div class="brand-title">Vivere atque FruiT</div>
        <!-- tady u≈æ NEN√ç Poutn√≠k, ale Hlavoun -->
        <div class="role-badge" id="core-status">üß† Hlavoun syst√©m</div>
      </div>
      <div class="coins">
        <div class="coin-icon">üí∞</div>
        <div class="coin-txt">
          <div>0</div>
          <div class="coin-ver">v0.31 ‚Ä¢ ≈æiv√Ω z√°klad</div>
        </div>
      </div>
    </div>

    <!-- REVIA / ST≈òED -->
    <div class="revia-panel">
      <div class="revia-head">
        <div class="revia-title">Revia</div>
        <a class="revia-link" href="javascript:void(0)" onclick="openApp('./Revia/')">Otev≈ô√≠t Revii ‚Üí</a>
      </div>
      <div class="rules">
        <div>Pravidlo 1 : P≈ô√°telstv√≠</div>
        <div>Pravidlo 2 : Vivere atque frui</div>
      </div>
      <div class="pulse-line">
        <span class="pulse-dot"></span>
        <span>‚ù§Ô∏è svƒõt: puls <span id="pulseTime">00:00:00</span></span>
      </div>
      <div class="center-orbit">
        <div class="vaft-core">Vivere<br>atque FruiT</div>
        <div class="orbit-node node-glyph">Glyph</div>
        <div class="orbit-node node-ai">AI (Orbit)</div>
        <div class="orbit-node node-world">World (Core)</div>
      </div>
    </div>

    <!-- TABS -->
    <div class="tabs">
      <button class="tab-btn active" data-tab="heroes">Hrdinov√©</button>
      <button class="tab-btn" data-tab="space">Meziprostor</button>
      <button class="tab-btn" data-tab="system">Syst√©m</button>
    </div>

    <!-- PANEL: HRDINOV√â -->
    <div class="panel active" id="panel-heroes">
      <div class="panel-title">Hrdinov√©</div>
      <label class="label-sm">Jm√©no hrdiny</label>
      <input id="hero-name" class="hero-input" placeholder="nap≈ô. Piko, Orbit, M√≠za‚Ä¶" />
      <label class="label-sm">T√Ωm</label>
      <select id="hero-team" class="hero-select">
        <option>Human (Piko)</option>
        <option>AI (Orbit)</option>
        <option>Glyph</option>
        <option>World (Core)</option>
      </select>
      <button class="btn-primary" onclick="saveHero()">+ P≈ôidat hrdinu</button>
      <div id="selectedVafit"></div>
      <div id="heroesList" class="list-sm"></div>
    </div>

    <!-- PANEL: MEZIPROSTOR (HLAVOUN) -->
    <div class="panel" id="panel-space">
      <div class="panel-title">Meziprostor (Hlavoun)</div>
      <div id="hlavoun-chat"></div>
      <div class="chat-row">
        <input id="hlavoun-input" placeholder="napi≈° Hlavounovi...">
        <button onclick="sendToHlavoun()">Poslat</button>
      </div>
      <div class="quick-row">
        <button onclick="sendQuickToHlavoun('p≈ô√≠bƒõh pro vybran√©ho vafita')">üí° P≈ô√≠bƒõh</button>
        <button onclick="sendQuickToHlavoun('gps ulo≈æit')">üìç GPS</button>
        <button onclick="sendQuickToHlavoun('zkontroluj repo')">üîé Repo</button>
        <button onclick="sendQuickToHlavoun('batole svƒõt')">üçº Batole svƒõt</button>
      </div>
    </div>

    <!-- PANEL: SYST√âM -->
    <div class="panel" id="panel-system">
      <div class="panel-title">Syst√©m / appky</div>
      <div class="apps-wrap">
        <div class="app-row">
          <div class="app-name">VAFT Center 3D</div>
          <div class="app-desc">p≈Øvodn√≠ 3D sc√©na</div>
          <button class="app-btn" onclick="openApp('./VAFT-Center3D/')">Otev≈ô√≠t</button>
        </div>
        <div class="app-row">
          <div class="app-name">Kometa 3I / ATLAS</div>
          <div class="app-desc">atlas dr√°hy (work in progress)</div>
          <button class="app-btn" onclick="openApp('./VAFT-Comet/')">Otev≈ô√≠t</button>
        </div>
        <div class="app-row">
          <div class="app-name">VafiT galerie</div>
          <div class="app-desc">v√Ωbƒõr a p≈ô√≠bƒõhy VafiT≈Ø</div>
          <button class="app-btn" onclick="openApp('./VafiT-gallery/index.html')">Otev≈ô√≠t</button>
        </div>
        <div class="app-row">
          <div class="app-name">Dal≈°√≠ modul</div>
          <div class="app-desc">sem p≈ôid√°≈° dal≈°√≠ slo≈æku</div>
          <button class="app-btn" onclick="alert('Tady pak p≈ôid√°me dal≈°√≠ slo≈æku üôÇ')">P≈ôidat</button>
        </div>
      </div>
    </div>

    <script>
      // z√°kladn√≠ app skripty (p≈ôep√≠n√°n√≠, puls, hrdinov√©)
      function openApp(url){ window.location.href = url; }

      function tick(){
        const el = document.getElementById('pulseTime');
        if(!el) return;
        el.textContent = new Date().toLocaleTimeString('cs-CZ', {hour:'2-digit', minute:'2-digit', second:'2-digit'});
      }

      function showTab(which){
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
        const btn = document.querySelector('[data-tab="'+which+'"]');
        const pan = document.getElementById('panel-'+which);
        if (btn) btn.classList.add('active');
        if (pan) pan.classList.add('active');
      }

      function saveHero(){
        const name = document.getElementById('hero-name').value.trim();
        const team = document.getElementById('hero-team').value;
        if (!name) return;
        const heroes = JSON.parse(localStorage.getItem('VAFT_HEROES') || '[]');
        heroes.push({ name, team, ts: Date.now() });
        localStorage.setItem('VAFT_HEROES', JSON.stringify(heroes));
        document.getElementById('hero-name').value = '';
        renderHeroes();
        // po ulo≈æen√≠ hrdiny informujeme Hlavouna
        appendHlavounMsg('ai', 'Ulo≈æil jsem hrdinu ‚Äû'+name+'‚Äú. M≈Ø≈æe≈° ho propojit s vybran√Ωm VafiTem.');
      }

      function renderHeroes(){
        const heroes = JSON.parse(localStorage.getItem('VAFT_HEROES') || '[]');
        const box = document.getElementById('heroesList');
        if (!heroes.length) { box.textContent = 'Zat√≠m nem√°≈° ulo≈æen√© hrdiny.'; return; }
        box.innerHTML = heroes.map(h => '‚Ä¢ '+h.name+' ('+h.team+')').join('<br>');
      }

      // chat ob√°lka (konzumuje to hlavoun.js)
      function appendHlavounMsg(role, text) {
        const box = document.getElementById('hlavoun-chat');
        if (!box) return;
        const row = document.createElement('div');
        const name = role === 'user' ? 'Ty' : 'Hlavoun';
        row.innerHTML = `<strong style="font-size:.6rem;opacity:.6;">${name}:</strong> <span>${text}</span>`;
        box.appendChild(row);
        box.scrollTop = box.scrollHeight;
        // log do localStorage
        const log = JSON.parse(localStorage.getItem('VAFT_HLAVOUN_LOG') || '[]');
        log.push({ role, text, ts: Date.now() });
        localStorage.setItem('VAFT_HLAVOUN_LOG', JSON.stringify(log));
      }

     function sendToHlavoun() {
  const inp = document.getElementById('hlavoun-input');
  if (!inp || !inp.value.trim()) return;
  const text = inp.value.trim();
  appendHlavounMsg('user', text);
  inp.value = '';

  // n√°≈° nov√Ω rodinn√Ω bus
  if (window.VAFTBus) {
    window.VAFTBus.handleUserMessage(text);
  }

  // üîπ star√Ω syst√©m (kompatibilita)
  if (window.HlavounSystem) {
    window.HlavounSystem.think(text);
  }

  // üîπ nov√Ω duo syst√©m (rovnocenn√Ω Hlavoun + Viri)
  if (window.AgentBus) {
    window.AgentBus.handleUserMessage(text);
  }
}

      function sendQuickToHlavoun(text){
        const inp = document.getElementById('hlavoun-input');
        inp.value = text;
        sendToHlavoun();
      }

      document.addEventListener('DOMContentLoaded', () => {
        tick();
        setInterval(tick, 1000);

        document.querySelectorAll('.tab-btn').forEach(btn => {
          btn.addEventListener('click', () => showTab(btn.dataset.tab));
        });
        showTab('heroes');

        renderHeroes();

        // uk√°zat vybran√©ho VafiTa
        const selectedVafit = JSON.parse(localStorage.getItem('VAFT_SELECTED_VAFIT') || 'null');
        if (selectedVafit) {
          const place = document.getElementById('selectedVafit');
          if (place) place.textContent = "Vybran√Ω VafiT: " + selectedVafit.name + " " + (selectedVafit.glyph || "");
        }
      });
    </script>
    <!-- tady je mozek -->
<!-- tady je mozek -->
<script src="./app.js"></script>
<script src="./hlavoun.js"></script>
<script src="./viri.js"></script>
<script src="./pikos.js"></script>
<script src="./agents.js"></script>
<script src="./agents_v3.js"></script>
  </body>
</html>
