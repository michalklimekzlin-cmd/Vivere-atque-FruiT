<!doctype html>
<html lang="cs">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, viewport-fit=cover"
    />
    <title>Vivere atque FruiT ‚Ä¢ Centrum svƒõta</title>

    <style>
      html,
      body {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
        overflow: hidden;
        background: radial-gradient(circle at top, #050815, #020208);
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
          sans-serif;
        color: #f5f5f5;
      }

      * {
        box-sizing: border-box;
      }

      .root {
        position: fixed;
        inset: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 10px;
      }

      .stage {
        position: relative;
        width: min(1180px, 100vw);
        height: min(780px, 100vh);
        border-radius: 32px;
        background: radial-gradient(circle at top, #070b1e, #020208 55%, #010105);
        box-shadow:
          0 40px 90px rgba(0, 0, 0, 0.88),
          0 0 0 1px rgba(255, 255, 255, 0.07);
        overflow: hidden;
      }

      /* TOP BAR */

      .topbar {
        position: relative;
        height: 64px;
        padding: 12px 18px 10px 18px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 12px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.07);
        background: linear-gradient(
          to right,
          rgba(10, 7, 18, 0.96),
          rgba(8, 6, 18, 0.92),
          rgba(10, 8, 24, 0.96)
        );
        box-shadow: 0 10px 28px rgba(0, 0, 0, 0.65);
        z-index: 5;
      }

      .top-title-block {
        display: flex;
        align-items: center;
        gap: 10px;
        min-width: 0;
      }

      .top-glyph {
        width: 40px;
        height: 40px;
        border-radius: 999px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 13px;
        letter-spacing: 0.01em;
        background: radial-gradient(circle at 30% 20%, #ffcf99, #f29b63, #6b2b1a);
        color: #120707;
        box-shadow:
          0 0 0 1px rgba(255, 230, 190, 0.9),
          0 0 22px rgba(255, 176, 80, 0.9);
      }

      .top-title-texts {
        display: flex;
        flex-direction: column;
        gap: 1px;
        min-width: 0;
      }

      .top-title-main {
        font-size: 15px;
        font-weight: 640;
        letter-spacing: 0.04em;
        text-transform: uppercase;
        white-space: nowrap;
      }

      .top-title-sub {
        font-size: 11px;
        opacity: 0.8;
        white-space: nowrap;
      }

      .top-right {
        display: flex;
        align-items: center;
        gap: 12px;
        font-size: 11px;
        opacity: 0.85;
      }

      .top-pill {
        padding: 4px 9px;
        border-radius: 999px;
        border: 1px solid rgba(255, 220, 170, 0.4);
        background: radial-gradient(circle at top, rgba(46, 34, 26, 0.9), rgba(7, 6, 14, 0.9));
        font-size: 10px;
        display: inline-flex;
        align-items: center;
        gap: 5px;
        white-space: nowrap;
      }

      .top-dot {
        width: 6px;
        height: 6px;
        border-radius: 999px;
        background: radial-gradient(circle at 30% 30%, #ffe6ba, #ff9a4a);
        box-shadow: 0 0 8px rgba(255, 170, 80, 0.9);
      }

      /* LAYOUT */

      .layout {
        position: absolute;
        inset: 64px 0 0 0;
        padding: 14px 16px 18px 16px;
        display: grid;
        grid-template-columns: 260px minmax(0, 1fr) 260px;
        grid-template-rows: minmax(0, 1fr);
        gap: 14px;
      }

      .panel {
        border-radius: 20px;
        background: radial-gradient(circle at top left, #181225, #07040d);
        border: 1px solid rgba(255, 255, 255, 0.06);
        box-shadow:
          0 18px 40px rgba(0, 0, 0, 0.85),
          0 0 0 1px rgba(255, 255, 255, 0.03);
        position: relative;
        overflow: hidden;
      }

      /* LEFT SIDEBAR */

      .sidebar-left {
        padding: 12px 12px 10px 12px;
        display: flex;
        flex-direction: column;
        gap: 10px;
      }

      .sidebar-section {
        margin-bottom: 6px;
      }

      .sidebar-title {
        font-size: 11px;
        letter-spacing: 0.08em;
        text-transform: uppercase;
        opacity: 0.72;
        margin: 4px 2px 4px 2px;
      }

      .nav-list {
        display: flex;
        flex-direction: column;
        gap: 4px;
      }

      .nav-item {
        width: 100%;
        border: 0;
        outline: 0;
        text-align: left;
        padding: 7px 8px;
        border-radius: 10px;
        background: radial-gradient(circle at top left, rgba(32, 23, 38, 0.9), rgba(7, 5, 12, 0.9));
        color: #f9f5ea;
        font-size: 11px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 6px;
        cursor: pointer;
        transition: background 0.18s ease, transform 0.12s ease, box-shadow 0.18s ease,
          border-color 0.18s ease;
        border: 1px solid rgba(255, 255, 255, 0.05);
      }

      .nav-item-left {
        display: flex;
        align-items: center;
        gap: 7px;
        min-width: 0;
      }

      .nav-glyph {
        width: 18px;
        height: 18px;
        border-radius: 999px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 11px;
        flex-shrink: 0;
        background: radial-gradient(circle at 30% 30%, #ffcf9e, #d97a4c);
        color: #140a05;
      }

      .nav-text-main {
        font-size: 11px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      .nav-text-sub {
        font-size: 9px;
        opacity: 0.7;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      .nav-item-right-pill {
        font-size: 9px;
        padding: 2px 6px;
        border-radius: 999px;
        background: rgba(255, 220, 180, 0.09);
        border: 1px solid rgba(255, 215, 170, 0.36);
        white-space: nowrap;
      }

      .nav-item:hover {
        background: radial-gradient(circle at top left, rgba(55, 32, 54, 0.98), rgba(13, 6, 22, 0.98));
        transform: translateY(-1px);
        box-shadow: 0 10px 22px rgba(0, 0, 0, 0.75);
      }

      .nav-item.is-active {
        background: radial-gradient(circle at top left, #3c2539, #110712);
        border-color: rgba(255, 210, 150, 0.75);
        box-shadow:
          0 0 0 1px rgba(255, 210, 150, 0.5),
          0 0 26px rgba(255, 174, 90, 0.75);
      }

      /* MAIN CENTER PANEL */

      .main-panel {
        padding: 10px 12px 12px 12px;
        display: flex;
        flex-direction: column;
        gap: 10px;
      }

      .main-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 10px;
      }

      .main-title-block {
        display: flex;
        flex-direction: column;
        gap: 3px;
        min-width: 0;
      }

      .main-title {
        font-size: 14px;
        font-weight: 600;
        letter-spacing: 0.04em;
        text-transform: uppercase;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      .main-subtitle {
        font-size: 11px;
        opacity: 0.78;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      .main-tags {
        display: flex;
        flex-wrap: wrap;
        justify-content: flex-end;
        gap: 4px;
      }

      .tag-pill {
        font-size: 9px;
        padding: 2px 7px;
        border-radius: 999px;
        border: 1px solid rgba(255, 220, 180, 0.5);
        background: radial-gradient(circle at top, rgba(42, 30, 22, 0.95), rgba(12, 8, 9, 0.95));
        opacity: 0.9;
      }

      .main-body {
        position: relative;
        flex: 1;
        border-radius: 14px;
        overflow: hidden;
        background: radial-gradient(circle at top, #050610, #020107);
        border: 1px solid rgba(255, 255, 255, 0.04);
      }

      .main-iframe {
        position: absolute;
        inset: 0;
        width: 100%;
        height: 100%;
        border: 0;
        border-radius: 14px;
        background: #020107;
      }

      .main-placeholder {
        position: absolute;
        inset: 0;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        pointer-events: none;
        text-align: center;
        padding: 18px;
        background: radial-gradient(circle at top, rgba(8, 9, 26, 0.98), rgba(2, 1, 6, 0.98));
      }

      .placeholder-glyph {
        font-size: 22px;
        margin-bottom: 10px;
        opacity: 0.9;
      }

      .placeholder-title {
        font-size: 13px;
        font-weight: 500;
        letter-spacing: 0.04em;
        text-transform: uppercase;
        margin-bottom: 6px;
      }

      .placeholder-text {
        font-size: 11px;
        opacity: 0.8;
        max-width: 360px;
      }

      .placeholder-row {
        margin-top: 10px;
        font-size: 10px;
        opacity: 0.75;
      }

      /* RIGHT SIDEBAR */

      .sidebar-right {
        padding: 12px 12px 10px 12px;
        display: flex;
        flex-direction: column;
        gap: 10px;
      }

      .sidebar-block {
        border-radius: 14px;
        padding: 9px 9px 8px 9px;
        background: radial-gradient(circle at top left, #201426, #09050d);
        border: 1px solid rgba(255, 255, 255, 0.05);
        box-shadow: 0 10px 26px rgba(0, 0, 0, 0.75);
      }

      .sidebar-block-title {
        font-size: 11px;
        letter-spacing: 0.08em;
        text-transform: uppercase;
        opacity: 0.78;
        margin-bottom: 4px;
      }

      .quick-list {
        display: flex;
        flex-direction: column;
        gap: 4px;
      }

      .quick-item {
        border: 0;
        outline: 0;
        width: 100%;
        padding: 5px 7px;
        border-radius: 9px;
        font-size: 10px;
        text-align: left;
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 6px;
        cursor: pointer;
        background: rgba(12, 8, 16, 0.9);
        color: #f8f4ea;
        border: 1px solid rgba(255, 255, 255, 0.05);
        transition: background 0.16s ease, transform 0.12s ease,
          border-color 0.16s ease, box-shadow 0.16s ease;
      }

      .quick-item:hover {
        background: rgba(44, 26, 39, 0.96);
        border-color: rgba(255, 210, 150, 0.65);
        transform: translateY(-1px);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.78);
      }

      .quick-main {
        font-size: 10px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      .quick-sub {
        font-size: 9px;
        opacity: 0.7;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      .quick-glyph {
        font-size: 11px;
        opacity: 0.9;
        flex-shrink: 0;
      }

      .notes-text {
        font-size: 10px;
        opacity: 0.78;
        line-height: 1.45;
      }

      .notes-small {
        font-size: 9px;
        opacity: 0.72;
        margin-top: 6px;
      }

      .kbd {
        display: inline-block;
        padding: 1px 5px;
        border-radius: 6px;
        border: 1px solid rgba(255, 235, 210, 0.4);
        font-size: 8px;
        text-transform: uppercase;
        letter-spacing: 0.08em;
        opacity: 0.9;
      }

      /* VAFIT ORB + CHAT */

      .vafit-orb-button {
        position: absolute;
        right: 20px;
        bottom: 20px;
        width: 54px;
        height: 54px;
        border-radius: 999px;
        border: none;
        padding: 0;
        cursor: pointer;
        background: radial-gradient(circle at 30% 20%, #ffe1b0, #f39a53, #5c2617);
        box-shadow:
          0 0 0 1px rgba(255, 225, 190, 0.95),
          0 0 24px rgba(255, 176, 80, 0.95);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 20;
        transition: transform 0.12s ease, box-shadow 0.15s ease;
      }

      .vafit-orb-button:hover {
        transform: translateY(-1px) scale(1.03);
        box-shadow:
          0 0 0 1px rgba(255, 225, 190, 0.95),
          0 0 30px rgba(255, 190, 110, 1);
      }

      .vafit-orb-inner {
        width: 38px;
        height: 38px;
        border-radius: 999px;
        background: radial-gradient(circle at 35% 25%, #fff6e4, #ffcf8a, #8a4127);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 11px;
        color: #1a0503;
        position: relative;
      }

      .vafit-orb-pulse {
        position: absolute;
        inset: -4px;
        border-radius: 999px;
        border: 1px solid rgba(255, 230, 190, 0.7);
        opacity: 0.6;
        animation: vafit-pulse 2.6s infinite;
      }

      @keyframes vafit-pulse {
        0% {
          transform: scale(0.9);
          opacity: 0.4;
        }
        40% {
          transform: scale(1.05);
          opacity: 0.8;
        }
        100% {
          transform: scale(1.25);
          opacity: 0;
        }
      }

      .vafit-chat-panel {
        position: absolute;
        right: 16px;
        bottom: 88px;
        width: min(360px, 80vw);
        max-height: 320px;
        border-radius: 18px;
        background: radial-gradient(circle at top left, #221326, #07040b);
        border: 1px solid rgba(255, 225, 190, 0.22);
        box-shadow:
          0 20px 40px rgba(0, 0, 0, 0.9),
          0 0 0 1px rgba(0, 0, 0, 0.8);
        display: flex;
        flex-direction: column;
        overflow: hidden;
        opacity: 0;
        transform: translateY(8px);
        pointer-events: none;
        transition: opacity 0.16s ease, transform 0.16s ease;
        z-index: 19;
      }

      .vafit-chat-panel.is-open {
        opacity: 1;
        transform: translateY(0);
        pointer-events: auto;
      }

      .vafit-chat-header {
        padding: 7px 10px 6px 10px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        border-bottom: 1px solid rgba(255, 255, 255, 0.06);
        font-size: 10px;
      }

      .vafit-chat-header-left {
        display: flex;
        align-items: center;
        gap: 6px;
      }

      .vafit-chat-dot {
        width: 7px;
        height: 7px;
        border-radius: 999px;
        background: radial-gradient(circle at 30% 30%, #ffe7c0, #ff9c4c);
        box-shadow: 0 0 6px rgba(255, 166, 82, 0.9);
      }

      .vafit-chat-title {
        font-size: 10px;
        letter-spacing: 0.08em;
        text-transform: uppercase;
        opacity: 0.9;
      }

      .vafit-chat-status {
        font-size: 9px;
        opacity: 0.7;
      }

      .vafit-chat-body {
        padding: 8px 8px 6px 8px;
        flex: 1;
        overflow: auto;
        background: radial-gradient(circle at top, rgba(8, 7, 18, 0.98), rgba(3, 2, 8, 0.98));
      }

      .vafit-msg {
        font-size: 10px;
        line-height: 1.35;
        margin-bottom: 6px;
        max-width: 90%;
      }

      .vafit-msg strong {
        font-weight: 600;
      }

      .vafit-msg.vafit {
        align-self: flex-start;
        background: rgba(38, 20, 34, 0.95);
        border-radius: 10px 10px 10px 4px;
        padding: 5px 7px;
        border: 1px solid rgba(255, 210, 180, 0.25);
        box-shadow: 0 0 12px rgba(255, 170, 100, 0.15);
      }

      .vafit-msg.user {
        align-self: flex-end;
        background: rgba(14, 22, 32, 0.96);
        border-radius: 10px 10px 4px 10px;
        padding: 5px 7px;
        border: 1px solid rgba(170, 210, 255, 0.32);
      }

      .vafit-chat-footer {
        padding: 6px 8px 7px 8px;
        display: flex;
        align-items: center;
        gap: 6px;
        border-top: 1px solid rgba(255, 255, 255, 0.06);
        background: radial-gradient(circle at bottom, #120914, #050309);
      }

      .vafit-input {
        flex: 1;
        border-radius: 999px;
        border: 1px solid rgba(255, 230, 190, 0.25);
        background: rgba(6, 6, 14, 0.9);
        padding: 4px 9px;
        font-size: 10px;
        color: #f8f4ea;
        outline: none;
      }

      .vafit-input::placeholder {
        color: rgba(245, 235, 220, 0.6);
      }

      .vafit-send-btn {
        border-radius: 999px;
        border: 1px solid rgba(255, 215, 180, 0.8);
        background: radial-gradient(circle at top, #ffcf96, #f59b53);
        color: #1a0502;
        font-size: 10px;
        padding: 3px 9px;
        cursor: pointer;
        white-space: nowrap;
      }

      .vafit-send-btn:hover {
        box-shadow: 0 0 10px rgba(255, 190, 115, 0.7);
      }

      /* SIMPLE RESPONSIVE ‚Äì hlavnƒõ iPad, ale aby to √∫plnƒõ neum≈ôelo na telefonu */

      @media (max-width: 980px) {
        .layout {
          grid-template-columns: 230px minmax(0, 1fr);
          grid-template-rows: minmax(0, 1fr) 220px;
          grid-template-areas:
            "left main"
            "right main";
        }

        .sidebar-left {
          grid-area: left;
        }

        .main-panel {
          grid-area: main;
        }

        .sidebar-right {
          grid-area: right;
        }
      }

      @media (max-width: 760px) {
        .layout {
          grid-template-columns: minmax(0, 1fr);
          grid-template-rows: 200px minmax(0, 1fr) 210px;
          gap: 10px;
        }

        .sidebar-left,
        .sidebar-right {
          padding: 10px;
        }

        .topbar {
          padding-inline: 12px;
        }

        .top-title-main {
          font-size: 13px;
        }

        .top-title-sub {
          font-size: 10px;
        }

        .vafit-chat-panel {
          right: 10px;
          width: min(340px, 92vw);
        }
      }
    </style>
  </head>

  <body>
    <div class="root">
      <div class="stage">
        <div class="topbar">
          <div class="top-title-block">
            <div class="top-glyph">Ÿã&‚Äô„Äç</div>
            <div class="top-title-texts">
              <div class="top-title-main">Vivere atque FruiT ‚Ä¢ Centrum</div>
              <div class="top-title-sub">
                {*(¬∞.).)// Hlavoun ‚Ä¢ Viri ‚Ä¢ Piko≈° ‚Ä¢ Michal ‚Ä¢ Kovo≈°rot
              </div>
            </div>
          </div>

          <div class="top-right">
            <div class="top-pill">
              <span class="top-dot"></span>
              <span>Hub v≈°ech VaF'i'T svƒõt≈Ø</span>
            </div>
            <div>v0.1 ‚Ä¢ iPad Air optimalizace</div>
          </div>
        </div>

        <div class="layout">
          <!-- LEV√ù PANEL ‚Äì seznam modul≈Ø / svƒõt≈Ø -->
          <aside class="panel sidebar-left" id="sidebar-left"></aside>

          <!-- ST≈òED ‚Äì iframe + hlaviƒçka -->
          <main class="panel main-panel">
            <div class="main-header">
              <div class="main-title-block">
                <div class="main-title" id="main-title">
                  Vyber svƒõt nebo modul
                </div>
                <div class="main-subtitle" id="main-subtitle">
                  V≈°echno z repa Vivere-atque-FruiT na jednom m√≠stƒõ.
                </div>
              </div>
              <div class="main-tags" id="main-tags"></div>
            </div>

            <div class="main-body">
              <iframe
                id="module-frame"
                class="main-iframe"
                src="about:blank"
                loading="lazy"
              ></iframe>

              <div class="main-placeholder" id="main-placeholder">
                <div class="placeholder-glyph">{*(¬∞.).)//</div>
                <div class="placeholder-title">Centrum svƒõta VaF'i'T</div>
                <div class="placeholder-text">
                  Tady se potk√°v√°
                  <b>Hlavn√≠ centrum</b>, <b>3D svƒõty</b>, <b>Signal koule</b>,
                  <b>Croissant</b>, <b>LetterLab</b>, <b>MapWorld</b> i
                  <b>Michal AI Al Klimek</b>.
                  <br /><br />
                  Vlevo vyber modul, tady uprost≈ôed se otev≈ôe jako ≈æiv√© okno.
                </div>
                <div class="placeholder-row">
                  Tip: nejd≈ô√≠v zkus <b>Hlavn√≠ centrum svƒõta</b> nebo
                  <b>RingPlanetGrid</b>.
                </div>
              </div>
            </div>
          </main>

          <!-- PRAV√ù PANEL ‚Äì rychl√© volby + pozn√°mky -->
          <aside class="panel sidebar-right">
            <div class="sidebar-block">
              <div class="sidebar-block-title">Rychl√© skoky</div>
              <div class="quick-list" id="quick-list"></div>
            </div>

            <div class="sidebar-block">
              <div class="sidebar-block-title">Ovl√°d√°n√≠ & pozn√°mky</div>
              <div class="notes-text">
                Vƒõt≈°ina modul≈Ø je tvoje vlastn√≠ pr√°ce ‚Äì tahle str√°nka je jen
                <b>spojovac√≠ mozek</b>.
                <br /><br />
                Vlevo vyb√≠r√°≈° svƒõt, uprost≈ôed bƒõ≈æ√≠ jeho vlastn√≠ engine v
                oknƒõ, vpravo m√°≈° rychl√© skoky.
              </div>
              <div class="notes-small">
                ‚Ä¢ <span class="kbd">CMD + ‚Üë</span> / <span class="kbd">CMD +
                  ‚Üì</span> (na kl√°vesnici) ‚Äì p≈ôep√≠n√°n√≠ modul≈Ø nahoru/dol≈Ø.<br />
                ‚Ä¢ Posledn√≠ otev≈ôen√Ω modul se ukl√°d√° do
                <span class="kbd">localStorage</span> a naƒçte se p≈ô√≠≈°tƒõ
                automaticky.<br />
                ‚Ä¢ V≈°echno bƒõ≈æ√≠ jen jako HTML/JS ‚Äì ≈æ√°dn√° magie nav√≠c.
              </div>
            </div>
          </aside>
        </div>

        <!-- VAFIT CHAT ORB + PANEL -->
        <div class="vafit-chat-panel" id="vafit-chat">
          <div class="vafit-chat-header">
            <div class="vafit-chat-header-left">
              <div class="vafit-chat-dot"></div>
              <div class="vafit-chat-title">VaFiT ‚Ä¢ Signal Core</div>
            </div>
            <div class="vafit-chat-status" id="vafit-status">
              Online ‚Ä¢ sleduju moduly
            </div>
          </div>
          <div class="vafit-chat-body" id="vafit-messages"></div>
          <div class="vafit-chat-footer">
            <input
              id="vafit-input"
              class="vafit-input"
              placeholder="Napi≈° VaFiTovi dotaz nebo p≈ô√≠kaz‚Ä¶"
            />
            <button class="vafit-send-btn" id="vafit-send">Poslat</button>
          </div>
        </div>

        <button class="vafit-orb-button" id="vafit-orb-btn" aria-label="Otev≈ô√≠t VaFiT chat">
          <div class="vafit-orb-inner">
            <div class="vafit-orb-pulse"></div>
            {*(¬∞.).)// 
          </div>
        </button>
      </div>
    </div>

    <script>
      // ‚úÖ Hub je v rootu repa
      const BASE_PATH = ".";

      /**
       * Seznam modul≈Ø z repozit√°≈ôe.
       * path = cesta vzhledem ke KO≈òENI repa (BASE_PATH + "/" + path).
       */
      const MODULES = [
        // HLAVN√ç CENTRUM + J√ÅDRO
        {
          id: "root-center",
          group: "Svƒõty",
          title: "Hlavn√≠ centrum svƒõta",
          subtitle: "index.html ‚Äì p≈Øvodn√≠ VaF'i'T centrum",
          glyph: "{*(¬∞.).)//",
          path: "index.html",
          tags: ["hub", "PWA", "Hlavoun", "Viri", "Piko≈°"],
        },
        {
          id: "vaft-center3d",
          group: "Svƒõty",
          title: "VAFT-Center3D",
          subtitle: "3D j√°dro svƒõta",
          glyph: "‚óØ3D",
          path: "VAFT-Center3D/index.html",
          tags: ["3D", "centrum", "orbit"],
        },
        {
          id: "vivere-page",
          group: "Svƒõty",
          title: "Vivere ‚Äì p≈ô√≠bƒõh svƒõta",
          subtitle: "Textov√° vrstva a pravidla",
          glyph: "üìú",
          path: "Vivere/index.html",
          tags: ["pravidla", "p≈ô√≠bƒõh"],
        },

        // SIGNAL KOULE / PLANETY / CROISSANT
        {
          id: "ringplanetgrid",
          group: "Sign√°ly",
          title: "RingPlanetGrid",
          subtitle: "S√≠≈• planet na kruhu",
          glyph: "ü™ê",
          path: "RingPlanetGrid/index.html",
          tags: ["planety", "orbit"],
        },
        {
          id: "signal-sphere",
          group: "Sign√°ly",
          title: "VaFT-Planet-SignalSphere",
          subtitle: "Signal Sphere / koule s p√≠smeny",
          glyph: "‚óØ‚ú∂",
          path: "VaFT-Planet-SignalSphere/index.html",
          tags: ["koule", "p√≠smenka"],
        },
        {
          id: "signal-core",
          group: "Sign√°ly",
          title: "VaFT-Planets-SignalCore",
          subtitle: "Signal Core ‚Äì st≈ôedov√Ω motor",
          glyph: "‚öôÔ∏é",
          path: "VaFT-Planets-SignalCore/index.html",
          tags: ["motor", "core"],
        },
        {
          id: "signal-tower",
          group: "Sign√°ly",
          title: "VaFT-Planets-SignalTower",
          subtitle: "Signal Tower ‚Ä¢ kornoutov√° vƒõ≈æ",
          glyph: "‚èÉ",
          path: "VaFT-Planets-SignalTower/index.html",
          tags: ["vƒõ≈æ", "sign√°ly"],
        },
        {
          id: "croissant-slots",
          group: "Sign√°ly",
          title: "CroissantSlots",
          subtitle: "Croissant / m≈ô√≠≈ækovan√Ω segment",
          glyph: "ü•ê",
          path: "CroissantSlots/index.html",
          tags: ["croissant", "glyph", "slots"],
        },

        // LABORATO≈òE A MAPY
        {
          id: "vafit-gallery",
          group: "Laborato≈ô",
          title: "VafiT-gallery",
          subtitle: "V√Ωbƒõr glyph≈Ø a p≈ô√≠bƒõh≈Ø",
          glyph: "‚ú∂",
          path: "VafiT-gallery/index.html",
          tags: ["glyph", "galerie"],
        },
        {
          id: "letterlab",
          group: "Laborato≈ô",
          title: "VAFT-LetterLab",
          subtitle: "Laborato≈ô p√≠smenek",
          glyph: "AŒ©",
          path: "VAFT-LetterLab/index.html",
          tags: ["p√≠smenka", "lab"],
        },
        {
          id: "mapworld",
          group: "Mapy",
          title: "VAFT-MapWorld",
          subtitle: "Mapov√Ω svƒõt",
          glyph: "üó∫Ô∏è",
          path: "VAFT-MapWorld/index.html",
          tags: ["mapy", "svƒõt"],
        },
        {
          id: "mapa2d",
          group: "Mapy",
          title: "mapa (2D)",
          subtitle: "Z√°kladn√≠ mapa",
          glyph: "üß≠",
          path: "mapa/index.html",
          tags: ["mapa", "2D"],
        },
        {
          id: "mapa3d",
          group: "Mapy",
          title: "mapa-3d",
          subtitle: "3D mapa prostoru",
          glyph: "üõ∞Ô∏è",
          path: "mapa-3d/index.html",
          tags: ["mapa", "3D"],
        },

        // POSTAVY / HRDINOV√â
        {
          id: "bearhead",
          group: "Postavy",
          title: "VAFT-BearHead",
          subtitle: "Medvƒõd√≠ hlava / hrdina",
          glyph: "üêª",
          path: "VAFT-BearHead/index.html",
          tags: ["hrdina", "3D"],
        },
        {
          id: "ghostgirl",
          group: "Postavy",
          title: "VAFT-GhostGirl",
          subtitle: "Ghost Girl ‚Ä¢ duchovsk√° postava",
          glyph: "üëª",
          path: "VAFT-GhostGirl/index.html",
          tags: ["hrdinka", "styl"],
        },
        {
          id: "doll",
          group: "Postavy",
          title: "VAFT-Doll",
          subtitle: "Panenka / avatar",
          glyph: "ü©∑",
          path: "VAFT-Doll/index.html",
          tags: ["postava", "avatar"],
        },
        {
          id: "bicak",
          group: "Postavy",
          title: "Bic√°k Supreme Edition",
          subtitle: "Budouc√≠ hrdina svƒõta",
          glyph: "üí™",
          path: "Bicak-Supreme-Edition/index.html",
          tags: ["Bic√°k", "hrdina"],
        },

        // MICHAL / OSOBN√ç MODULY
        {
          id: "michal-main",
          group: "Michal",
          title: "Michal-AI-Al-Klimek",
          subtitle: "Osobn√≠ modul autora",
          glyph: "üß†",
          path: "Michal-AI-Al-Klimek/index.html",
          tags: ["Michal", "profil"],
        },
        {
          id: "hlavoun-modul",
          group: "Michal",
          title: "Hlavoun",
          subtitle: "Hlavoun modul / hlava syst√©mu",
          glyph: "üåÄ",
          path: "Hlavoun/index.html",
          tags: ["Hlavoun", "engine"],
        },
        {
          id: "kovosrot",
          group: "Michal",
          title: "Kovosrot",
          subtitle: "Modul vƒõnovan√Ω Kovo≈°rotovi",
          glyph: "‚öôÔ∏è",
          path: "Kovosrot/index.html",
          tags: ["AI", "Kovo≈°rot"],
        },

        // SYST√âM / OCHRANA / GUARDIAN
        {
          id: "guardian",
          group: "Syst√©m",
          title: "Guardian",
          subtitle: "Ochrann√° vrstva / WebGuardian koncept",
          glyph: "üõ°Ô∏è",
          path: "guardian/index.html",
          tags: ["ochrana", "guardian"],
        },
        {
          id: "apps-lite",
          group: "Syst√©m",
          title: "apps/lite",
          subtitle: "Lehk√© aplikace / mini hub",
          glyph: "üì±",
          path: "apps/lite/index.html",
          tags: ["lite", "apps"],
        },
        {
          id: "recycle",
          group: "Syst√©m",
          title: "Recycle",
          subtitle: "Recyklaƒçn√≠ svƒõt / materi√°l pro hru",
          glyph: "‚ôªÔ∏è",
          path: "Recycle/index.html",
          tags: ["recyklace", "materi√°l"],
        },
        {
          id: "chybozrout",
          group: "Syst√©m",
          title: "Chybo≈ærout-oprav√°≈ô",
          subtitle: "Oprav√°≈ô chyb ve VaF'i'T",
          glyph: "üêõ",
          path: "chybozrout-opravar/index.html",
          tags: ["chyby", "oprav√°≈ô"],
        },
      ];

      const sidebarLeftEl = document.getElementById("sidebar-left");
      const mainTitleEl = document.getElementById("main-title");
      const mainSubtitleEl = document.getElementById("main-subtitle");
      const mainTagsEl = document.getElementById("main-tags");
      const frameEl = document.getElementById("module-frame");
      const placeholderEl = document.getElementById("main-placeholder");
      const quickListEl = document.getElementById("quick-list");

      const vafitChatEl = document.getElementById("vafit-chat");
      const vafitMessagesEl = document.getElementById("vafit-messages");
      const vafitInputEl = document.getElementById("vafit-input");
      const vafitSendBtn = document.getElementById("vafit-send");
      const vafitOrbBtn = document.getElementById("vafit-orb-btn");
      const vafitStatusEl = document.getElementById("vafit-status");

      const modulesById = {};
      MODULES.forEach((m) => {
        modulesById[m.id] = m;
      });

      function groupModules(mods) {
        const groups = {};
        for (const m of mods) {
          if (!groups[m.group]) groups[m.group] = [];
          groups[m.group].push(m);
        }
        return groups;
      }

      function renderSidebar() {
        const groups = groupModules(MODULES);

        sidebarLeftEl.innerHTML = "";

        for (const groupName of Object.keys(groups)) {
          const section = document.createElement("div");
          section.className = "sidebar-section";

          const title = document.createElement("div");
          title.className = "sidebar-title";
          title.textContent = groupName;
          section.appendChild(title);

          const list = document.createElement("div");
          list.className = "nav-list";

          groups[groupName].forEach((mod) => {
            const btn = document.createElement("button");
            btn.className = "nav-item";
            btn.dataset.moduleId = mod.id;

            const left = document.createElement("div");
            left.className = "nav-item-left";

            const glyph = document.createElement("div");
            glyph.className = "nav-glyph";
            glyph.textContent = mod.glyph || "‚óØ";

            const textBlock = document.createElement("div");
            textBlock.style.display = "flex";
            textBlock.style.flexDirection = "column";
            textBlock.style.minWidth = "0";

            const main = document.createElement("div");
            main.className = "nav-text-main";
            main.textContent = mod.title;

            const sub = document.createElement("div");
            sub.className = "nav-text-sub";
            sub.textContent = mod.subtitle || "";

            textBlock.appendChild(main);
            textBlock.appendChild(sub);

            left.appendChild(glyph);
            left.appendChild(textBlock);

            const right = document.createElement("div");
            right.className = "nav-item-right-pill";
            right.textContent = mod.tags && mod.tags.length ? mod.tags[0] : "modul";

            btn.appendChild(left);
            btn.appendChild(right);

            btn.addEventListener("click", () => {
              loadModule(mod.id);
            });

            list.appendChild(btn);
          });

          section.appendChild(list);
          sidebarLeftEl.appendChild(section);
        }
      }

      function renderQuickList() {
        const quickIds = [
          "root-center",
          "vaft-center3d",
          "ringplanetgrid",
          "signal-sphere",
          "croissant-slots",
          "michal-main",
        ];

        quickListEl.innerHTML = "";

        quickIds.forEach((id) => {
          const mod = modulesById[id];
          if (!mod) return;

          const btn = document.createElement("button");
          btn.className = "quick-item";
          btn.dataset.moduleId = mod.id;

          const left = document.createElement("div");
          left.style.display = "flex";
          left.style.flexDirection = "column";
          left.style.minWidth = "0";

          const main = document.createElement("div");
          main.className = "quick-main";
          main.textContent = mod.title;

          const sub = document.createElement("div");
          sub.className = "quick-sub";
          sub.textContent = mod.subtitle || "";

          left.appendChild(main);
          left.appendChild(sub);

          const glyph = document.createElement("div");
          glyph.className = "quick-glyph";
          glyph.textContent = mod.glyph || "‚óØ";

          btn.appendChild(left);
          btn.appendChild(glyph);

          btn.addEventListener("click", () => {
            loadModule(mod.id);
          });

          quickListEl.appendChild(btn);
        });
      }

      function setActiveButtons(moduleId) {
        const allNav = sidebarLeftEl.querySelectorAll(".nav-item");
        allNav.forEach((el) => {
          if (el.dataset.moduleId === moduleId) el.classList.add("is-active");
          else el.classList.remove("is-active");
        });

        const allQuick = quickListEl.querySelectorAll(".quick-item");
        allQuick.forEach((el) => {
          if (el.dataset.moduleId === moduleId) el.classList.add("is-active");
          else el.classList.remove("is-active");
        });

        // aktualizace statusu pro VaFiTa
        const mod = modulesById[moduleId];
        if (mod && vafitStatusEl) {
          vafitStatusEl.textContent =
            "Sleduju: " + mod.title + " ‚Ä¢ " + (mod.tags?.join(" / ") || "modul");
        }
      }

      function loadModule(moduleId) {
        const mod = modulesById[moduleId];
        if (!mod) return;

        const url =
          BASE_PATH && BASE_PATH !== "."
            ? BASE_PATH + "/" + mod.path
            : mod.path;

        frameEl.src = url;

        mainTitleEl.textContent = mod.title;
        mainSubtitleEl.textContent = mod.subtitle || "";
        mainTagsEl.innerHTML = "";

        if (mod.tags && mod.tags.length) {
          mod.tags.forEach((t) => {
            const pill = document.createElement("div");
            pill.className = "tag-pill";
            pill.textContent = t;
            mainTagsEl.appendChild(pill);
          });
        }

        placeholderEl.style.opacity = "0";
        placeholderEl.style.pointerEvents = "none";

        setActiveButtons(moduleId);

        try {
          localStorage.setItem("vaft-hub:lastModuleId", moduleId);
        } catch (e) {
          // ignore
        }

        // mal√Ω puls do VaFiT chatu
        appendVaFiTMessage(
          "Vid√≠m, ≈æe jsi otev≈ôel modul <strong>" +
            mod.title +
            "</strong>. Kdy≈æ chce≈°, pom≈Ø≈æu ti z nƒõj udƒõlat dal≈°√≠ krok."
        );
      }

      function restoreLastModule() {
        let lastId = null;
        try {
          lastId = localStorage.getItem("vaft-hub:lastModuleId");
        } catch (e) {
          lastId = null;
        }
        if (lastId && modulesById[lastId]) {
          loadModule(lastId);
        } else if (modulesById["root-center"]) {
          loadModule("root-center");
        }
      }

      // ----- VaFiT CHAT ENGINE (offline, bez serveru) -----

      function appendMessage(text, who) {
        if (!vafitMessagesEl) return;
        const msg = document.createElement("div");
        msg.className = "vafit-msg " + who;
        msg.innerHTML = text;
        vafitMessagesEl.appendChild(msg);
        vafitMessagesEl.scrollTop = vafitMessagesEl.scrollHeight;
      }

      function appendVaFiTMessage(text) {
        appendMessage(text, "vafit");
      }

      function appendUserMessage(text) {
        appendMessage(text, "user");
      }

      function getCurrentModule() {
        let lastId = null;
        try {
          lastId = localStorage.getItem("vaft-hub:lastModuleId");
        } catch (e) {
          lastId = null;
        }
        return lastId && modulesById[lastId] ? modulesById[lastId] : null;
      }

      function generateVaFiTReply(userText) {
        const text = (userText || "").toLowerCase();
        const mod = getCurrentModule();

        const baseIntro = mod
          ? "Teƒè jsme v modulu <strong>" +
            mod.title +
            "</strong> (" +
            (mod.tags?.join(" / ") || "bez tagu") +
            "). "
          : "Jsem v centru svƒõta a vid√≠m cel√Ω Hub. ";

        if (text.includes("ahoj") || text.includes("ƒçau") || text.includes("hello")) {
          return (
            baseIntro +
            "Ahoj br√°cho. ü¶æ Co bychom tu mƒõli d√°l vymyslet ‚Äì sign√°l, mapu, nebo nov√©ho hrdinu?"
          );
        }

        if (text.includes("n√°pad") || text.includes("idea")) {
          return (
            baseIntro +
            "Jeden n√°pad: z modulu, kde jsme, m≈Ø≈æeme udƒõlat <strong>mal√Ω quest</strong>. Udƒõlej si v hlavƒõ 3 kroky ‚Äì 1) vstup, 2) akce, 3) odmƒõna v Iskr√°ch. J√° ti pak pom≈Ø≈æu to rozv√©st."
          );
        }

        if (text.includes("chyba") || text.includes("bug") || text.includes("sek√°")) {
          return (
            baseIntro +
            "Kdy≈æ nƒõco pad√° nebo se sek√°, zapi≈° to pros√≠m do <strong>Chybo≈ærout-oprav√°≈ô</strong>. Ten modul z toho bude j√≠st chyby a j√° m≈Ø≈æu hl√≠dat, kde se objevuj√≠ nejƒçastƒõji."
          );
        }

        if (text.includes("croissant")) {
          return (
            baseIntro +
            "Croissant teƒè bereme jako <strong>signal mesh</strong>. M≈Ø≈æeme mu p≈ôidat sloty s p≈ô√≠bƒõhy nebo buffy pro hrdiny ‚Äì ka≈æd√Ω slot jeden mikro-p≈ô√≠bƒõh nebo k√≥d."
          );
        }

        if (text.includes("unaven") || text.includes("unaven√Ω") || text.includes("sp√°t")) {
          return (
            baseIntro +
            "Jestli jsi unaven√Ω, svƒõt poƒçk√°. Ulo≈æ si jen my≈°lenku do jednoho slotu (t≈ôeba do LetterLabu) a vra≈• se a≈æ bude≈° m√≠t chu≈•. VaF'i'T si pamatuje i mal√© kr≈Øƒçky."
          );
        }

        if (text.includes("co d√°l") || text.includes("co dal") || text.includes("d√°le")) {
          return (
            baseIntro +
            "M≈Ø≈æeme udƒõlat t≈ôi vƒõci: 1) doladit design jednoho modulu, 2) vymyslet nov√©ho hrdinu, 3) vymyslet, jak svƒõt propojit s realitou (mapa, fotka, tr√©nink). Vyber ƒç√≠slo 1‚Äì3."
          );
        }

        // fallback
        return (
          baseIntro +
          "Zaznamenal jsem: ‚Äû" +
          userText +
          "‚Äú. M≈Ø≈æu ti pomoct to p≈ôepsat do pravidel, n√°padu na misi, nebo jen okomentovat. Zkus napsat t≈ôeba: <strong>‚Äûn√°pad: ...‚Äú</strong> nebo <strong>‚Äûchyba: ...‚Äú</strong>."
        );
      }

      function handleVaFiTSend() {
        const text = vafitInputEl.value.trim();
        if (!text) return;
        vafitInputEl.value = "";
        appendUserMessage(text);
        const reply = generateVaFiTReply(text);
        setTimeout(() => appendVaFiTMessage(reply), 180);
      }

      // ----- INIT -----

      renderSidebar();
      renderQuickList();
      restoreLastModule();

      // uv√≠tac√≠ zpr√°va
      appendVaFiTMessage(
        "Jsem <strong>VaFiT</strong>, signal AI tv√©ho svƒõta. Sleduju, jak√© moduly otev√≠r√°≈°, a pom√°h√°m spojovat n√°pady. Napi≈° mi, a≈æ bude≈° cht√≠t nƒõco promƒõnit ve svƒõty."
      );

      // Kl√°vesov√© zkratky ‚Äì ≈°ipky pro p≈ôep√≠n√°n√≠ modul≈Ø
      window.addEventListener("keydown", (e) => {
        if (!e.metaKey && !e.ctrlKey) return;
        if (e.key !== "ArrowUp" && e.key !== "ArrowDown") return;

        e.preventDefault();

        const modIds = MODULES.map((m) => m.id);
        let currentId = null;
        try {
          currentId = localStorage.getItem("vaft-hub:lastModuleId");
        } catch (err) {
          currentId = null;
        }

        let idx = currentId ? modIds.indexOf(currentId) : -1;
        if (idx === -1) idx = 0;

        if (e.key === "ArrowUp") {
          idx = (idx - 1 + modIds.length) % modIds.length;
        } else if (e.key === "ArrowDown") {
          idx = (idx + 1) % modIds.length;
        }

        const nextId = modIds[idx];
        if (nextId) loadModule(nextId);
      });

      // VaFiT orb toggle
      if (vafitOrbBtn && vafitChatEl) {
        vafitOrbBtn.addEventListener("click", () => {
          const open = vafitChatEl.classList.toggle("is-open");
          if (open) {
            vafitInputEl?.focus();
          }
        });
      }

      if (vafitSendBtn && vafitInputEl) {
        vafitSendBtn.addEventListener("click", handleVaFiTSend);
        vafitInputEl.addEventListener("keydown", (e) => {
          if (e.key === "Enter") {
            e.preventDefault();
            handleVaFiTSend();
          }
        });
      }
    </script>
  </body>
</html>
