<!doctype html>
<html lang="cs">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, viewport-fit=cover"
    />
    <title>Vivere atque FruiT • Základní rámeček</title>

    <style>
      :root {
        --barva-pozadi: #020308;
        --barva-linky: #14151c;
        --barva-ramecek-hrana: #111111;   /* černá kostra */
        --barva-ramecek-seda: #5f646c;    /* šedé šrafované plochy */
        --barva-ramecek-cervena: #c93b3b; /* červený střed */
        --barva-text: #f5f5f5;
        --barva-text-slabsi: #b2b2c7;
        --font-zaklad: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
          sans-serif;
      }

      * {
        box-sizing: border-box;
      }

      html,
      body {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
        overflow: hidden;
        background: radial-gradient(circle at top, #050818, var(--barva-pozadi));
        color: var(--barva-text);
        font-family: var(--font-zaklad);
      }

      .vrstva-koren {
        position: fixed;
        inset: 0;
        display: flex;
        align-items: stretch;
        justify-content: stretch;
      }

      canvas#platno-ramecek {
        width: 100%;
        height: 100%;
        display: block;
      }

      .vrstva-horni-panel {
        position: fixed;
        inset: 0 auto auto 0;
        padding: 10px 14px;
        display: flex;
        flex-direction: column;
        gap: 4px;
        pointer-events: none;
      }

      .znacka-aplikace {
        font-size: 14px;
        letter-spacing: 0.08em;
        text-transform: uppercase;
        color: var(--barva-text-slabsi);
      }

      .radek-stav {
        display: flex;
        gap: 10px;
        align-items: center;
        font-size: 12px;
        color: var(--barva-text-slabsi);
      }

      .odznak-zivy {
        padding: 2px 6px;
        border-radius: 999px;
        background: rgba(248, 103, 166, 0.14);
        border: 1px solid rgba(248, 103, 166, 0.8);
        color: #ffd7f0;
        font-size: 11px;
      }

      .vrstva-spodni-panel {
        position: fixed;
        inset: auto 0 0 0;
        padding: 10px 16px 14px;
        background: linear-gradient(
          to top,
          rgba(0, 0, 0, 0.65),
          rgba(0, 0, 0, 0)
        );
        display: flex;
        flex-direction: column;
        gap: 6px;
        pointer-events: none;
      }

      .radek-informace-ramecek {
        font-size: 11px;
        color: var(--barva-text-slabsi);
      }

      .radek-sloty {
        display: flex;
        gap: 6px;
        flex-wrap: wrap;
      }

      .odznak-slot {
        padding: 4px 8px;
        border-radius: 999px;
        border: 1px solid rgba(150, 150, 190, 0.6);
        background: rgba(10, 10, 30, 0.7);
        font-size: 11px;
        color: var(--barva-text-slabsi);
        pointer-events: auto;
        user-select: none;
      }

      .odznak-slot--aktivni {
        border-color: var(--barva-ramecek-cervena);
        color: #ffe9b0;
        box-shadow: 0 0 8px rgba(201, 59, 59, 0.7);
      }

      .odznak-slot-klic {
        opacity: 0.7;
      }
    </style>
  </head>
  <body>
    <div class="vrstva-koren">
      <canvas id="platno-ramecek"></canvas>
    </div>

    <!-- horní info vrstva \\{*(°•.)(.•°)*}// -->
    <div class="vrstva-horni-panel">
      <div class="znacka-aplikace">Vivere atque FruiT • základní rámeček</div>
      <div class="radek-stav">
        <span class="odznak-zivy">živý panel • kostra</span>
        <span id="stav-slot-aktivni">aktivní slot: střed 1</span>
        <span id="stav-lupa">lupa: střed</span>
      </div>
    </div>

    <!-- spodní info vrstva: připínání modulů v budoucnu -->
    <div class="vrstva-spodni-panel">
      <div class="radek-informace-ramecek">
        2D rámeček: bílá kostra, šedé šrafované plochy (vršek a bok), červený
        pohyblivý střed se 4 sloty pro písmenka / objekty / AI.
      </div>
      <div class="radek-sloty" id="panel-sloty">
        <div class="odznak-slot odznak-slot--aktivni" data-slot="0">
          Střed 1 • písmenka
        </div>
        <div class="odznak-slot" data-slot="1">Střed 2 • volný</div>
        <div class="odznak-slot" data-slot="2">Střed 3 • volný</div>
        <div class="odznak-slot" data-slot="3">Střed 4 • volný</div>
        <div class="odznak-slot odznak-slot-klic">≋ budoucí modul: svět</div>
        <div class="odznak-slot odznak-slot-klic">≋ budoucí modul: AI</div>
        <div class="odznak-slot odznak-slot-klic">≋ budoucí modul: glyph</div>
        <div class="odznak-slot odznak-slot-klic">≋ budoucí modul: VaFiT</div>
      </div>
    </div>

    <script>
      "use strict";

      // …iT… základní datový model rámečku \\{*(°•.)(.•°)*}//

      /**
       * Stav jednoho vkládacího středu.
       */
      class VkladaciStred {
        constructor(id, popis, typObsahu = "pismenka") {
          this.id = id;
          this.popis = popis;
          this.typObsahu = typObsahu; // "pismenka" | "objekt" | "ai" | "glyph" | ...
          this.obsah = null; // bude se doplňovat moduly
        }
      }

      /**
       * Základní 2D rámeček: vnější kostra + vnitřní 4 sloty.
       */
      class ZakladniRamecek {
        constructor() {
          this.meritko = 1;
          this.rezimLupy = "stred"; // "stred" | "cely"
          this.aktivniStredIndex = 0;

          this.pritahovaciHak = {
            aktivni: true,
            dosah: 24,
            sila: 0.35,
          };

          this.stredy = [
            new VkladaciStred("stred-1", "Střed 1 • písmenka", "pismenka"),
            new VkladaciStred("stred-2", "Střed 2 • volný", "volny"),
            new VkladaciStred("stred-3", "Střed 3 • volný", "volny"),
            new VkladaciStred("stred-4", "Střed 4 • volný", "volny"),
          ];
        }

        prepniAktivniStred(index) {
          if (index < 0 || index >= this.stredy.length) return;
          this.aktivniStredIndex = index;
        }

        prepniRezimLupy() {
          this.rezimLupy = this.rezimLupy === "stred" ? "cely" : "stred";
        }

        zvetseni(delta) {
          const nove = this.meritko + delta;
          this.meritko = Math.min(Math.max(nove, 0.5), 2.2);
        }
      }

      // ────────────────────────────────────────────────
      // Inicializace plátna a kreslení
      // ────────────────────────────────────────────────

      const platno = document.getElementById("platno-ramecek");
      const kontext = platno.getContext("2d");
      const ramecek = new ZakladniRamecek();

      function zmenitVelikostPlatna() {
        const pomer = window.devicePixelRatio || 1;
        const sirkaCss = window.innerWidth;
        const vyskaCss = window.innerHeight;

        platno.width = sirkaCss * pomer;
        platno.height = vyskaCss * pomer;

        kontext.setTransform(pomer, 0, 0, pomer, 0, 0);
        prekreslit();
      }

      window.addEventListener("resize", zmenitVelikostPlatna);
      zmenitVelikostPlatna();

      function prekreslit() {
        const sirka = platno.width / (window.devicePixelRatio || 1);
        const vyska = platno.height / (window.devicePixelRatio || 1);
        kontext.clearRect(0, 0, sirka, vyska);

        vykreslitPozadi(kontext, sirka, vyska);
        vykreslitRamecek2D(kontext, sirka, vyska, ramecek);
      }

      function vykreslitPozadi(ctx, sirka, vyska) {
        ctx.save();
        ctx.strokeStyle = "rgba(40,45,65,0.4)";
        ctx.lineWidth = 1;

        const krok = 40;
        for (let x = 0; x <= sirka; x += krok) {
          ctx.beginPath();
          ctx.moveTo(x, 0);
          ctx.lineTo(x, vyska);
          ctx.stroke();
        }
        for (let y = 0; y <= vyska; y += krok) {
          ctx.beginPath();
          ctx.moveTo(0, y);
          ctx.lineTo(sirka, y);
          ctx.stroke();
        }
        ctx.restore();
      }

      // hlavní kreslení rámečku podle papírového náčrtu

      function vykreslitRamecek2D(ctx, sirka, vyska, stavRamecku) {
        ctx.save();

        const velikost = Math.min(sirka, vyska) * 0.4 * stavRamecku.meritko;
        const hloubka = velikost * 0.5; // "délka" boků
        const stredX = sirka / 2;
        const stredY = vyska / 2 + velikost * 0.05;

        // přední plášť (bílá kostra)
        const pLevo = stredX - velikost / 2;
        const pPravo = stredX + velikost / 2;
        const pNahore = stredY - velikost / 2;
        const pDole = stredY + velikost / 2;

        const dx = hloubka * 0.35;
        const dy = -hloubka * 0.4;

        // přední vnější obdélník
        const A = { x: pLevo, y: pNahore };
        const B = { x: pPravo, y: pNahore };
        const C = { x: pPravo, y: pDole };
        const D = { x: pLevo, y: pDole };

        // zadní pravý horní roh kvádru pro horní a boční plochu
        const E = { x: B.x + dx, y: B.y + dy };
        const F = { x: C.x + dx, y: C.y + dy };

        // vnitřní "okno" (otevřený prostor)
        const vnitOdsazeni = velikost * 0.18;
        const iA = { x: A.x + vnitOdsazeni, y: A.y + vnitOdsazeni };
        const iB = { x: B.x - vnitOdsazeni, y: B.y + vnitOdsazeni };
        const iC = { x: C.x - vnitOdsazeni, y: C.y - vnitOdsazeni };
        const iD = { x: D.x + vnitOdsazeni, y: D.y - vnitOdsazeni };

        // zadní rovina vnitřního prostoru (červený střed)
        const zadDx = vnitOdsazeni * 0.6;
        const zadDy = -vnitOdsazeni * 0.7;
        const jA = { x: iA.x + zadDx, y: iA.y + zadDy };
        const jB = { x: iB.x + zadDx, y: iB.y + zadDy };
        const jC = { x: iC.x + zadDx, y: iC.y + zadDy };
        const jD = { x: iD.x + zadDx, y: iD.y + zadDy };

        // 1) šedý vršek
        ctx.fillStyle = getComputedStyle(
          document.documentElement
        ).getPropertyValue("--barva-ramecek-seda");
        ctx.strokeStyle = getComputedStyle(
          document.documentElement
        ).getPropertyValue("--barva-ramecek-hrana");
        ctx.lineWidth = 2;

        ctx.beginPath();
        ctx.moveTo(A.x, A.y);
        ctx.lineTo(B.x, B.y);
        ctx.lineTo(E.x, E.y);
        ctx.lineTo(A.x + dx * 0.3, A.y + dy); // mírně kratší horní hrana vzadu
        ctx.closePath();
        ctx.fill();
        ctx.stroke();

        // šrafování vršku
        srafovatPlochu(
          ctx,
          { x1: A.x, y1: A.y, x2: B.x, y2: B.y },
          { x1: A.x + dx * 0.3, y1: A.y + dy, x2: E.x, y2: E.y },
          6,
          0.8
        );

        // 2) šedý pravý bok
        ctx.beginPath();
        ctx.moveTo(B.x, B.y);
        ctx.lineTo(C.x, C.y);
        ctx.lineTo(F.x, F.y);
        ctx.lineTo(E.x, E.y);
        ctx.closePath();
        ctx.fill();
        ctx.stroke();

        srafovatPlochu(
          ctx,
          { x1: B.x, y1: B.y, x2: C.x, y2: C.y },
          { x1: E.x, y1: E.y, x2: F.x, y2: F.y },
          6,
          1
        );

        // 3) bílá kostra přední části
        ctx.lineWidth = 3;
        ctx.strokeStyle = getComputedStyle(
          document.documentElement
        ).getPropertyValue("--barva-ramecek-hrana");
        ctx.fillStyle = "#fdfdfd";

        // vnější přední obdélník
        ctx.beginPath();
        ctx.moveTo(A.x, A.y);
        ctx.lineTo(B.x, B.y);
        ctx.lineTo(C.x, C.y);
        ctx.lineTo(D.x, D.y);
        ctx.closePath();
        ctx.fill();
        ctx.stroke();

        // vyříznutí vnitřního okna (jen kontura)
        ctx.save();
        ctx.globalCompositeOperation = "destination-out";
        ctx.beginPath();
        ctx.moveTo(iA.x, iA.y);
        ctx.lineTo(iB.x, iB.y);
        ctx.lineTo(iC.x, iC.y);
        ctx.lineTo(iD.x, iD.y);
        ctx.closePath();
        ctx.fill();
        ctx.restore();

        // obrys vnitřního otvoru
        ctx.beginPath();
        ctx.moveTo(iA.x, iA.y);
        ctx.lineTo(iB.x, iB.y);
        ctx.lineTo(iC.x, iC.y);
        ctx.lineTo(iD.x, iD.y);
        ctx.closePath();
        ctx.stroke();

        // 4) červený střed (vnitřní prostor)
        ctx.fillStyle = getComputedStyle(
          document.documentElement
        ).getPropertyValue("--barva-ramecek-cervena");
        ctx.strokeStyle = "#5a1818";
        ctx.lineWidth = 2;

        ctx.beginPath();
        ctx.moveTo(jA.x, jA.y);
        ctx.lineTo(jB.x, jB.y);
        ctx.lineTo(jC.x, jC.y);
        ctx.lineTo(jD.x, jD.y);
        ctx.closePath();
        ctx.fill();
        ctx.stroke();

        // červené šrafování – vertikální + mírně diagonální
        srafovatPlochu(
          ctx,
          { x1: jA.x, y1: jA.y, x2: jB.x, y2: jB.y },
          { x1: jD.x, y1: jD.y, x2: jC.x, y2: jC.y },
          10,
          1,
          true
        );

        ctx.restore();
      }

      function srafovatPlochu(
        ctx,
        predniHrana,
        zadniHrana,
        pocetCaur,
        tloustka,
        diagonala = false
      ) {
        ctx.save();
        ctx.strokeStyle = "rgba(0,0,0,0.25)";
        ctx.lineWidth = tloustka;

        for (let i = 1; i < pocetCaur; i++) {
          const t = i / pocetCaur;

          const a = {
            x: predniHrana.x1 + (predniHrana.x2 - predniHrana.x1) * t,
            y: predniHrana.y1 + (predniHrana.y2 - predniHrana.y1) * t,
          };

          const b = {
            x: zadniHrana.x1 + (zadniHrana.x2 - zadniHrana.x1) * t,
            y: zadniHrana.y1 + (zadniHrana.y2 - zadniHrana.y1) * t,
          };

          ctx.beginPath();
          if (!diagonala) {
            ctx.moveTo(a.x, a.y);
            ctx.lineTo(b.x, b.y);
          } else {
            // lehce posunutá diagonála pro červený střed
            ctx.moveTo(a.x, a.y);
            ctx.lineTo(b.x + 6, b.y);
          }
          ctx.stroke();
        }

        ctx.restore();
      }

      // ────────────────────────────────────────────────
      // Interakce – připravené háčky
      // ────────────────────────────────────────────────

      const panelSloty = document.getElementById("panel-sloty");
      const textAktivni = document.getElementById("stav-slot-aktivni");
      const textLupa = document.getElementById("stav-lupa");

      panelSloty.addEventListener("click", (udalost) => {
        const cil = udalost.target.closest(".odznak-slot");
        if (!cil) return;
        const index = Number(cil.dataset.slot);
        if (Number.isNaN(index)) return;

        ramecek.prepniAktivniStred(index);
        aktualizovatSlotOdznaky();
        prekreslit();
      });

      function aktualizovatSlotOdznaky() {
        const odznaky = panelSloty.querySelectorAll(".odznak-slot[data-slot]");
        odznaky.forEach((el) => {
          const index = Number(el.dataset.slot);
          if (index === ramecek.aktivniStredIndex) {
            el.classList.add("odznak-slot--aktivni");
          } else {
            el.classList.remove("odznak-slot--aktivni");
          }
        });

        const aktivniStred = ramecek.stredy[ramecek.aktivniStredIndex];
        textAktivni.textContent = "aktivní slot: " + aktivniStred.popis;
        textLupa.textContent =
          "lupa: " + (ramecek.rezimLupy === "stred" ? "střed" : "celý rámeček");
      }

      aktualizovatSlotOdznaky();

      // zoom kolečkem (na mobilu později nahradíme pinch gestem)
      window.addEventListener(
        "wheel",
        (e) => {
          const delta = e.deltaY > 0 ? -0.05 : 0.05;
          ramecek.zvetseni(delta);
          prekreslit();
        },
        { passive: true }
      );

      // klepnutí na plátno přepíná režim lupy
      platno.addEventListener("click", () => {
        ramecek.prepniRezimLupy();
        aktualizovatSlotOdznaky();
      });

      // připravené háčky pro dotykové ovládání prstem (budeme doplňovat moduly)
      platno.addEventListener("pointerdown", (e) => {
        // ً&’ zde napojíme detailní ovládání:
        // otáčení, ladění, přibližování s "přitahovacím hákem".
      });

      // první vykreslení
      prekreslit();
    </script>
  </body>
</html>
