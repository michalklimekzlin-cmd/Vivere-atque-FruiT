<!doctype html>
<html lang="cs">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>VaFT • Koule z glyphů</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      background: radial-gradient(circle at center, #120507, #020103);
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      color: #f5f5f5;
    }
    canvas {
      position: fixed;
      inset: 0;
      display: block;
    }
    .label {
      position: fixed;
      left: 50%;
      bottom: 10px;
      transform: translateX(-50%);
      font-size: 11px;
      opacity: 0.6;
      pointer-events: none;
    }
  </style>
</head>
<body>

<canvas id="sphere"></canvas>
<div class="label">VaFT • Koule z glyphů (červená + bílá) podle tvé 4×4 tabulky</div>

<script>
(function () {
  "use strict";

  const canvas = document.getElementById("sphere");
  const ctx = canvas.getContext("2d");

  function resize() {
    const dpr = window.devicePixelRatio || 1;
    const w = window.innerWidth;
    const h = window.innerHeight;
    canvas.width = w * dpr;
    canvas.height = h * dpr;
    ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
  }
  resize();
  window.addEventListener("resize", resize);

  // 4×4 tabulka – stejné množství glyphů jako předtím
  const glyphGrid = [
    "ː", "¦", "∙", "!",
    "a", "b", "c", "^",
    "1", "2", "3", "4",
    "#", ".", "A", ")"
  ];

  const latSteps = 22;   // stejné hodnoty jako v původní verzi
  const lonSteps = 44;

  let rotation = 0;
  let lastTime = 0;

  function draw(time) {
    const w = window.innerWidth;
    const h = window.innerHeight;

    const cx = w / 2;          // přesně doprostřed X
    const cy = h / 2;          // přesně doprostřed Y
    const radius = Math.min(w, h) * 0.32; // stejná velikost koule

    const dt = lastTime ? (time - lastTime) : 16;
    lastTime = time;
    rotation += dt * 0.0007;   // plynulejší otáčení

    // pozadí
    const bg = ctx.createRadialGradient(cx, cy, 40, cx, cy, Math.max(w, h));
    bg.addColorStop(0.0, "#2a1214");
    bg.addColorStop(0.5, "#0b0507");
    bg.addColorStop(1.0, "#020103");
    ctx.fillStyle = bg;
    ctx.fillRect(0, 0, w, h);

    // koule – NEUBÍRÁM body ani glyphy
    for (let i = 0; i <= latSteps; i++) {
      const v = i / latSteps;
      const lat = (v - 0.5) * Math.PI; // -π/2 .. π/2

      for (let j = 0; j < lonSteps; j++) {
        const u = j / lonSteps;
        const lon = u * Math.PI * 2 + rotation;

        const x = Math.cos(lat) * Math.cos(lon);
        const y = Math.sin(lat);
        const z = Math.cos(lat) * Math.sin(lon);

        const depth = (z + 1) / 2; // 0..1 vpředu/vzadu

        const r = radius * (0.9 + depth * 0.15);
        const px = cx + x * r;
        const py = cy + y * r;

        const size = 1.4 + depth * 2.4;

        // světelný bod (gradient – stejné jako dřív)
        const grad = ctx.createRadialGradient(px, py, 0, px, py, size * 2.2);
        const whiteFactor = 0.4 + depth * 0.6;
        const redFactor   = 0.6 + (1 - depth) * 0.4;

        grad.addColorStop(0, `rgba(255,255,255,${whiteFactor})`);
        grad.addColorStop(0.5, `rgba(255,120,120,${redFactor})`);
        grad.addColorStop(1, "rgba(0,0,0,0)");

        ctx.fillStyle = grad;
        ctx.beginPath();
        ctx.arc(px, py, size * 2.2, 0, Math.PI * 2);
        ctx.fill();

        // glyph – pořád na všech viditelných bodech jako předtím
        if (depth > 0.25) {
          const idx = (i * lonSteps + j) % glyphGrid.length;
          const glyph = glyphGrid[idx];

          ctx.save();
          ctx.translate(px, py);
          ctx.font = `${8 + depth * 4}px monospace`;
          ctx.textAlign = "center";
          ctx.textBaseline = "middle";
          ctx.fillStyle = depth > 0.6
            ? "rgba(255,255,255,0.95)"
            : "rgba(255,200,200,0.9)";
          ctx.fillText(glyph, 0, 0);
          ctx.restore();
        }
      }
    }

    requestAnimationFrame(draw);
  }

  requestAnimationFrame(draw);
})();
</script>

</body>
</html>
