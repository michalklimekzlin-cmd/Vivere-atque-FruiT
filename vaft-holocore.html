<!doctype html>
<html lang="cs">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>VaFT • HoloCore – Holografická postava</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      background: #020208;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      color: #f5f5f5;
    }
    #holo-canvas {
      position: fixed;
      inset: 0;
      display: block;
    }
    .label {
      position: fixed;
      left: 50%;
      bottom: 12px;
      transform: translateX(-50%);
      font-size: 11px;
      opacity: 0.7;
      text-align: center;
      pointer-events: none;
    }
  </style>
</head>
<body>

<canvas id="holo-canvas"></canvas>
<div class="label">VaFT HoloCore • Holografická postava + kopule (základní styl)</div>

<!-- ZÁKLADNÍ KÁMEN -->
<script src="./VaFT-HoloCore.js"></script>

<script>
(function () {
  "use strict";

  var core = window.VaFTHoloCore;
  if (!core) {
    alert("VaFTHoloCore se nenačetl – zkontroluj název VaFT-HoloCore.js");
    return;
  }

  var HoloPalette   = core.HoloPalette;
  var Motion        = core.Motion;
  var createCurve   = core.createCurve;
  var createHoloObj = core.createHoloObject;

  var canvas = document.getElementById("holo-canvas");
  var ctx = canvas.getContext("2d");

  function resize() {
    var dpr = window.devicePixelRatio || 1;
    var w = window.innerWidth;
    var h = window.innerHeight;
    canvas.width = w * dpr;
    canvas.height = h * dpr;
    ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
  }
  resize();
  window.addEventListener("resize", resize);

  // --- Silueta člověka jako "kost" z bodů --------------------------
  var joints = {
    head:      { x:   0, y: -110 },
    neck:      { x:   0, y:  -90 },
    shoulderL: { x: -30, y:  -80 },
    shoulderR: { x:  30, y:  -80 },
    chest:     { x:   0, y:  -60 },
    hip:       { x:   0, y:  -20 },
    handL:     { x: -50, y:  -20 },
    handR:     { x:  50, y:  -20 },
    kneeL:     { x: -18, y:   25 },
    kneeR:     { x:  18, y:   25 },
    footL:     { x: -18, y:   70 },
    footR:     { x:  18, y:   70 }
  };

  function segment(a, b, steps) {
    var out = [];
    var n = steps || 16;
    for (var i = 0; i <= n; i++) {
      var t = i / n;
      out.push({
        x: a.x + (b.x - a.x) * t,
        y: a.y + (b.y - a.y) * t
      });
    }
    return out;
  }

  // body z jednotlivých segmentů
  var bodyPoints = []
    .concat(segment(joints.head, joints.neck, 14))
    .concat(segment(joints.neck, joints.chest, 10))
    .concat(segment(joints.chest, joints.hip, 10))
    .concat(segment(joints.shoulderL, joints.handL, 16))
    .concat(segment(joints.shoulderR, joints.handR, 16))
    .concat(segment(joints.hip, joints.kneeL, 12))
    .concat(segment(joints.kneeL, joints.footL, 12))
    .concat(segment(joints.hip, joints.kneeR, 12))
    .concat(segment(joints.kneeR, joints.footR, 12));

  // hlava jako kruh z bodů
  var headPoints = [];
  for (var i = 0; i < 40; i++) {
    var ang = (i / 40) * Math.PI * 2;
    headPoints.push({
      x: joints.head.x + Math.cos(ang) * 16,
      y: joints.head.y + Math.sin(ang) * 20
    });
  }

  // základní holo objekt (jen kvůli pulzu / dýchání)
  var holo = createHoloObj({
    curves: [],
    particles: 120,
    glow: 0.7,
    noise: 0.05,
    rotation: 0.0
  });

  // --- Animace ------------------------------------------------------
  function frame(ts) {
    var t = ts * 0.001;
    var w = window.innerWidth;
    var h = window.innerHeight;
    var cx = w / 2;
    var cy = h / 2 + 20;

    // pozadí (tmavý, lehce do hněda)
    var bg = ctx.createRadialGradient(cx, cy - 120, 40, cx, cy, Math.max(w, h));
    bg.addColorStop(0.0, "#171921");
    bg.addColorStop(0.5, "#07080c");
    bg.addColorStop(1.0, "#020208");
    ctx.fillStyle = bg;
    ctx.fillRect(0, 0, w, h);

    holo.tick(t);

    ctx.save();
    ctx.translate(cx, cy);

    var scaleBase = 1 + Math.sin(t * 1.1) * 0.03;
    ctx.scale(scaleBase, scaleBase);

    // --- základna ---------------------------------------------------
    ctx.globalAlpha = 0.9;
    var baseRadius = 95 + Math.sin(t * 1.4) * 4;

    ctx.beginPath();
    ctx.arc(0, 80, baseRadius, 0, Math.PI * 2);
    ctx.strokeStyle = "rgba(72, 165, 255, 0.8)";
    ctx.lineWidth = 1.5;
    ctx.stroke();

    // drobné body po základně
    ctx.globalAlpha = 0.7;
    for (var i = 0; i < 80; i++) {
      var angB = (i / 80) * Math.PI * 2;
      var rB = baseRadius + Math.sin(t * 2 + i * 0.3) * 3;
      var bx = Math.cos(angB) * rB;
      var by = 80 + Math.sin(angB) * 2;
      ctx.beginPath();
      ctx.arc(bx, by, 1.2, 0, Math.PI * 2);
      ctx.fillStyle = "rgba(120, 200, 255, 0.95)";
      ctx.fill();
    }

    // --- kopule / štít ----------------------------------------------
    ctx.globalAlpha = 0.45;
    ctx.lineWidth = 1.1;
    ctx.strokeStyle = "rgba(130, 210, 255, 0.8)";

    var domeRadius = 130;
    ctx.beginPath();
    ctx.arc(0, -10, domeRadius, Math.PI, 0, false);
    ctx.stroke();

    // body po kopuli
    ctx.globalAlpha = 0.9;
    for (var j = 0; j <= 42; j++) {
      var angD = Math.PI + (j / 42) * Math.PI;
      var dR = domeRadius + Math.sin(t * 2 + j * 0.4) * 3;
      var dx = Math.cos(angD) * dR;
      var dy = -10 + Math.sin(angD) * dR;
      ctx.beginPath();
      ctx.arc(dx, dy, 1.4, 0, Math.PI * 2);
      ctx.fillStyle = "rgba(170, 230, 255, 0.95)";
      ctx.fill();
    }

    // --- tělo – body / wireframe -----------------------------------
    ctx.globalAlpha = 0.9;
    ctx.fillStyle = "rgba(160, 225, 255, 0.95)";

    var i, p, wobble, px, py;

    // hlava
    for (i = 0; i < headPoints.length; i++) {
      p = headPoints[i];
      wobble = Motion.waveOffset(i, t, 0.8);
      px = p.x + wobble * 0.6;
      py = p.y + wobble * 0.3;
      ctx.beginPath();
      ctx.arc(px, py, 1.4, 0, Math.PI * 2);
      ctx.fill();
    }

    // tělo
    for (i = 0; i < bodyPoints.length; i++) {
      p = bodyPoints[i];
      wobble = Motion.waveOffset(i, t, 1.2);
      px = p.x + wobble * 0.4;
      py = p.y + wobble * 0.2;
      ctx.beginPath();
      ctx.arc(px, py, 1.5, 0, Math.PI * 2);
      ctx.fill();
    }

    // vertikální osová čára – páteř
    ctx.globalAlpha = 0.55;
    ctx.strokeStyle = "rgba(90, 190, 255, 0.9)";
    ctx.lineWidth = 1;

    ctx.beginPath();
    for (i = -110; i <= 70; i += 6) {
      var off = Motion.waveOffset(i * 0.3, t, 4);
      if (i === -110) ctx.moveTo(off, i);
      else ctx.lineTo(off, i);
    }
    ctx.stroke();

    // jemná aura částic okolo celé postavy
    ctx.globalAlpha = 0.45;
    for (i = 0; i < holo.particles; i++) {
      var a = (i / holo.particles) * Math.PI * 2;
      var rr = 50 + Math.sin(t * 1.3 + i * 0.8) * 30;
      var ax = Math.cos(a) * rr * 0.8;
      var ay = Math.sin(a) * rr * 0.9 - 10;
      ctx.beginPath();
      ctx.arc(ax, ay, 1.1, 0, Math.PI * 2);
      ctx.fillStyle = "rgba(120, 210, 255, 0.9)";
      ctx.fill();
    }

    ctx.restore();

    requestAnimationFrame(frame);
  }

  requestAnimationFrame(frame);
})();
</script>

</body>
</html>
