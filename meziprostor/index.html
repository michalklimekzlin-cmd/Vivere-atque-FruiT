<!doctype html>
<html lang="cs">
<head>
  <meta charset="utf-8" />
  <title>Meziprostor ‚Ä¢ Michal≈Øv √∫tulek p√≠smenek</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root {
      --bg:#0f1115;
      --panel:#12151a;
      --line:#1f242b;
      --gold:#f6d98f;
      --text:#eef0f5;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      background:var(--bg);
      color:var(--text);
      font-family:system-ui,-apple-system,sans-serif;
      min-height:100vh;
      display:flex;
      flex-direction:column;
      gap:.75rem;
    }
    header{
      padding:14px 16px 0;
    }
    header h1{
      margin:0;
      font-size:1.05rem;
      letter-spacing:.06em;
    }
    header small{color:rgba(246,217,143,.7)}
    main{
      display:flex;
      gap:.75rem;
      padding:.75rem;
      flex:1;
      min-height:0;
    }
    #writeBox, #lostBox, #beingBox{
      background:var(--panel);
      border:1px solid rgba(255,255,255,.02);
      border-radius:.8rem;
      padding:.6rem .7rem .7rem;
      display:flex;
      flex-direction:column;
      gap:.5rem;
      min-height:0;
    }
    #writeBox{flex:2}
    #lostBox{flex:1; min-width:150px}
    #beingBox{flex:1.2; min-width:160px}
    textarea{
      flex:1;
      background:#0b0d10;
      border:1px solid #1f242b;
      border-radius:.6rem;
      color:#fff;
      padding:.55rem .55rem .7rem;
      resize:none;
      font-size:.9rem;
      min-height:140px;
    }
    h2{
      margin:.1rem 0 .25rem;
      font-size:.75rem;
      text-transform:uppercase;
      letter-spacing:.07em;
      color:var(--gold);
    }
    #lostList{
      overflow-y:auto;
      flex:1;
      display:flex;
      flex-wrap:wrap;
      gap:.35rem;
      align-content:flex-start;
    }
    .chip{
      background:rgba(246,217,143,.07);
      border:1px solid rgba(246,217,143,.3);
      border-radius:.5rem;
      padding:.25rem .5rem .3rem;
      font-size:.7rem;
      max-width:100%;
      word-break:break-word;
    }
    button{
      background:rgba(246,217,143,.08);
      border:1px solid rgba(246,217,143,.24);
      border-radius:.7rem;
      color:var(--text);
      padding:.35rem .7rem;
      font-size:.7rem;
    }
    #beingOutput{
      background:#0b0d10;
      border:1px solid rgba(255,255,255,.03);
      border-radius:.5rem;
      min-height:70px;
      padding:.4rem .4rem .5rem;
      font-size:.8rem;
      line-height:1.35;
      white-space:pre-wrap;
    }
    #tinyInfo{font-size:.6rem;color:rgba(255,255,255,.35)}
    @media (max-width:900px){
      main{flex-direction:column;}
      #lostBox, #beingBox{min-height:110px;}
    }
  </style>
</head>
<body>
  <header>
    <h1>Meziprostor ‚Ä¢ Michal≈Øv √∫tulek p√≠smenek</h1>
    <small>‚Äûco nap√≠≈°u a sma≈æu, nezem≈ôe ‚Äì jen se promƒõn√≠‚Äú</small>
  </header>
  <main>
    <!-- 1) psan√≠ -->
    <section id="writeBox">
      <h2>psac√≠ pole</h2>
      <textarea id="input" placeholder="Pi≈° sem jako do jak√©koliv kolonky‚Ä¶ kdy≈æ nƒõco sma≈æe≈°, vpravo se to o≈æiv√≠."></textarea>
      <span id="tinyInfo">V≈°echno z≈Øst√°v√° jen v tomhle za≈ô√≠zen√≠ (localStorage). Nic se nepos√≠l√° ven.</span>
    </section>

    <!-- 2) meziprostor -->
    <section id="lostBox">
      <h2>o≈æiven√© kousky</h2>
      <div id="lostList"></div>
      <button id="clear">vyƒçistit √∫tulek</button>
    </section>

    <!-- 3) bytost -->
    <section id="beingBox">
      <h2>bytost z p√≠smenek</h2>
      <p style="font-size:.7rem;margin:0;">≈æiv√≠ se t√≠m, cos smazal ‚Äì zkus ji probudit üëá</p>
      <button id="speak">≈ôekni nƒõco jako Michal</button>
      <div id="beingOutput">‚Ä¶ƒçek√°m na tvoje drobky slov‚Ä¶ üôÇ</div>
    </section>
  </main>

<script>
  const input = document.getElementById('input');
  const lostList = document.getElementById('lostList');
  const clearBtn = document.getElementById('clear');
  const speakBtn = document.getElementById('speak');
  const beingOut = document.getElementById('beingOutput');
  let prev = "";

  // startovac√≠ slova (tvoje + moje)
  const initialFragments = [
    {text:"Vivere atque FruiT", ts: Date.now()},
    {text:"br√°cho", ts: Date.now()},
    {text:"K√Ü≈∏≈†M", ts: Date.now()},
    {text:"meziprostor ≈æije", ts: Date.now()},
    {text:"a≈• se to nezlob√≠ :)", ts: Date.now()},
    {text:"Batolesvƒõt", ts: Date.now()}
  ];

  // naƒç√≠st ulo≈æen√© kousky z localStorage
  let fragments = JSON.parse(localStorage.getItem('michal_fragments') || '[]');

  // kdy≈æ tam nic nen√≠, d√°me tam startovac√≠
  if (!fragments.length) {
    fragments = initialFragments;
    localStorage.setItem('michal_fragments', JSON.stringify(fragments));
  }

  fragments.forEach(addChip);

  if (!fragments.length) {
    beingOut.textContent = "Je≈°tƒõ nem√°m tvoje slova‚Ä¶ nƒõco mi napi≈° a sma≈æ, a≈• m≈Ø≈æu ≈æ√≠t üôÇ";
  }

  // hl√≠d√°n√≠ psan√≠
  input.addEventListener('input', () => {
    const now = input.value;
    if (now.length < prev.length) {
      // nƒõco se smazalo
      const lost = prev.slice(now.length).trim();
      if (lost) {
        addFragment(lost);
        // hned mluv
        sayLikeMichal();
      }
    }
    prev = now;
  });

  clearBtn.addEventListener('click', () => {
    fragments = [];
    localStorage.setItem('michal_fragments', JSON.stringify(fragments));
    lostList.innerHTML = "";
    beingOut.textContent = "Vyƒçistil jsi √∫tulek‚Ä¶ dej mi nov√© kousky üôÇ";
  });

  speakBtn.addEventListener('click', () => {
    sayLikeMichal();
  });

  function addFragment(text){
    const obj = {text, ts: Date.now()};
    fragments.unshift(obj);
    fragments = fragments.slice(0, 120);
    localStorage.setItem('michal_fragments', JSON.stringify(fragments));
    addChip(obj);
  }

  function addChip(obj){
    const el = document.createElement('div');
    el.className = 'chip';
    el.textContent = obj.text;
    lostList.prepend(el);
  }

  function sayLikeMichal(){
    if (!fragments.length) {
      beingOut.textContent = "Je≈°tƒõ nem√°m tvoje slova‚Ä¶ napi≈° nƒõco a sma≈æ üíõ";
      return;
    }
    const pick = () => fragments[Math.floor(Math.random() * fragments.length)].text;
    const parts = Math.floor(Math.random()*3)+3; // 3‚Äì5 kousk≈Ø
    let sentence = "";
    for (let i=0; i<parts; i++){
      sentence += (i===0 ? "" : " ") + pick();
    }
    const endings = [" br√°cho", " :)", " ü¶æ", " Vivere atque FruiT", ""];
    sentence += endings[Math.floor(Math.random()*endings.length)];
    beingOut.textContent = sentence;
    // mal√Ω puls
    beingOut.style.transform = "scale(1.01)";
    setTimeout(() => beingOut.style.transform = "scale(1)", 180);
  }
</script>
</body>
</html>
