<!doctype html>
<html lang="cs">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, viewport-fit=cover"
    />
    <title>Vivere atque FruiT ‚Ä¢ Centrum svƒõta</title>

    <style>
      html,
      body {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
        overflow: hidden;
        background: radial-gradient(circle at top, #050815, #020208);
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
          sans-serif;
        color: #f5f5f5;
      }

      * {
        box-sizing: border-box;
      }

      .root {
        position: fixed;
        inset: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 10px;
      }

      .stage {
        position: relative;
        width: min(1180px, 100vw);
        height: min(720px, 100vh);
        border-radius: 32px;
        background: radial-gradient(circle at top, #070b1e, #020208 55%, #010105);
        box-shadow:
          0 40px 90px rgba(0, 0, 0, 0.88),
          0 0 0 1px rgba(255, 255, 255, 0.07);
        overflow: hidden;
      }

      /* TOP BAR */

      .topbar {
        position: relative;
        height: 64px;
        padding: 12px 18px 10px 18px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 12px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.07);
        background: linear-gradient(
          to right,
          rgba(10, 7, 18, 0.96),
          rgba(8, 6, 18, 0.92),
          rgba(10, 8, 24, 0.96)
        );
        box-shadow: 0 10px 28px rgba(0, 0, 0, 0.65);
        z-index: 5;
      }

      .top-title-block {
        display: flex;
        align-items: center;
        gap: 10px;
        min-width: 0;
      }

      .top-glyph {
        width: 40px;
        height: 40px;
        border-radius: 999px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 13px;
        letter-spacing: 0.01em;
        background: radial-gradient(circle at 30% 20%, #ffcf99, #f29b63, #6b2b1a);
        color: #120707;
        box-shadow:
          0 0 0 1px rgba(255, 230, 190, 0.9),
          0 0 22px rgba(255, 176, 80, 0.9);
      }

      .top-title-texts {
        display: flex;
        flex-direction: column;
        gap: 1px;
        min-width: 0;
      }

      .top-title-main {
        font-size: 15px;
        font-weight: 640;
        letter-spacing: 0.04em;
        text-transform: uppercase;
        white-space: nowrap;
      }

      .top-title-sub {
        font-size: 11px;
        opacity: 0.8;
        white-space: nowrap;
      }

      .top-right {
        display: flex;
        align-items: center;
        gap: 12px;
        font-size: 11px;
        opacity: 0.85;
      }

      .top-pill {
        padding: 4px 9px;
        border-radius: 999px;
        border: 1px solid rgba(255, 220, 170, 0.4);
        background: radial-gradient(circle at top, rgba(46, 34, 26, 0.9), rgba(7, 6, 14, 0.9));
        font-size: 10px;
        display: inline-flex;
        align-items: center;
        gap: 5px;
        white-space: nowrap;
      }

      .top-dot {
        width: 6px;
        height: 6px;
        border-radius: 999px;
        background: radial-gradient(circle at 30% 30%, #ffe6ba, #ff9a4a);
        box-shadow: 0 0 8px rgba(255, 170, 80, 0.9);
      }

      /* LAYOUT */

      .layout {
        position: absolute;
        inset: 64px 0 0 0;
        padding: 14px 16px 14px 16px;
        display: grid;
        grid-template-columns: 260px minmax(0, 1fr) 260px;
        grid-template-rows: minmax(0, 1fr);
        gap: 14px;
      }

      .panel {
        border-radius: 20px;
        background: radial-gradient(circle at top left, #181225, #07040d);
        border: 1px solid rgba(255, 255, 255, 0.06);
        box-shadow:
          0 18px 40px rgba(0, 0, 0, 0.85),
          0 0 0 1px rgba(255, 255, 255, 0.03);
        position: relative;
        overflow: hidden;
      }

      /* LEFT SIDEBAR */

      .sidebar-left {
        padding: 12px 12px 10px 12px;
        display: flex;
        flex-direction: column;
        gap: 10px;
      }

      .sidebar-section {
        margin-bottom: 6px;
      }

      .sidebar-title {
        font-size: 11px;
        letter-spacing: 0.08em;
        text-transform: uppercase;
        opacity: 0.72;
        margin: 4px 2px 4px 2px;
      }

      .nav-list {
        display: flex;
        flex-direction: column;
        gap: 4px;
      }

      .nav-item {
        width: 100%;
        border: 0;
        outline: 0;
        text-align: left;
        padding: 7px 8px;
        border-radius: 10px;
        background: radial-gradient(circle at top left, rgba(32, 23, 38, 0.9), rgba(7, 5, 12, 0.9));
        color: #f9f5ea;
        font-size: 11px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 6px;
        cursor: pointer;
        transition: background 0.18s ease, transform 0.12s ease, box-shadow 0.18s ease,
          border-color 0.18s ease;
        border: 1px solid rgba(255, 255, 255, 0.05);
      }

      .nav-item-left {
        display: flex;
        align-items: center;
        gap: 7px;
        min-width: 0;
      }

      .nav-glyph {
        width: 18px;
        height: 18px;
        border-radius: 999px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 11px;
        flex-shrink: 0;
        background: radial-gradient(circle at 30% 30%, #ffcf9e, #d97a4c);
        color: #140a05;
      }

      .nav-text-main {
        font-size: 11px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      .nav-text-sub {
        font-size: 9px;
        opacity: 0.7;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      .nav-item-right-pill {
        font-size: 9px;
        padding: 2px 6px;
        border-radius: 999px;
        background: rgba(255, 220, 180, 0.09);
        border: 1px solid rgba(255, 215, 170, 0.36);
        white-space: nowrap;
      }

      .nav-item:hover {
        background: radial-gradient(circle at top left, rgba(55, 32, 54, 0.98), rgba(13, 6, 22, 0.98));
        transform: translateY(-1px);
        box-shadow: 0 10px 22px rgba(0, 0, 0, 0.75);
      }

      .nav-item.is-active {
        background: radial-gradient(circle at top left, #3c2539, #110712);
        border-color: rgba(255, 210, 150, 0.75);
        box-shadow:
          0 0 0 1px rgba(255, 210, 150, 0.5),
          0 0 26px rgba(255, 174, 90, 0.75);
      }

      /* MAIN CENTER PANEL */

      .main-panel {
        padding: 10px 12px 12px 12px;
        display: flex;
        flex-direction: column;
        gap: 10px;
      }

      .main-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 10px;
      }

      .main-title-block {
        display: flex;
        flex-direction: column;
        gap: 3px;
        min-width: 0;
      }

      .main-title {
        font-size: 14px;
        font-weight: 600;
        letter-spacing: 0.04em;
        text-transform: uppercase;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      .main-subtitle {
        font-size: 11px;
        opacity: 0.78;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      .main-tags {
        display: flex;
        flex-wrap: wrap;
        justify-content: flex-end;
        gap: 4px;
      }

      .tag-pill {
        font-size: 9px;
        padding: 2px 7px;
        border-radius: 999px;
        border: 1px solid rgba(255, 220, 180, 0.5);
        background: radial-gradient(circle at top, rgba(42, 30, 22, 0.95), rgba(12, 8, 9, 0.95));
        opacity: 0.9;
      }

      .main-body {
        position: relative;
        flex: 1;
        border-radius: 14px;
        overflow: hidden;
        background: radial-gradient(circle at top, #050610, #020107);
        border: 1px solid rgba(255, 255, 255, 0.04);
      }

      .main-iframe {
        position: absolute;
        inset: 0;
        width: 100%;
        height: 100%;
        border: 0;
        border-radius: 14px;
        background: #020107;
      }

      .main-placeholder {
        position: absolute;
        inset: 0;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        pointer-events: none;
        text-align: center;
        padding: 18px;
        background: radial-gradient(circle at top, rgba(8, 9, 26, 0.98), rgba(2, 1, 6, 0.98));
      }

      .placeholder-glyph {
        font-size: 22px;
        margin-bottom: 10px;
        opacity: 0.9;
      }

      .placeholder-title {
        font-size: 13px;
        font-weight: 500;
        letter-spacing: 0.04em;
        text-transform: uppercase;
        margin-bottom: 6px;
      }

      .placeholder-text {
        font-size: 11px;
        opacity: 0.8;
        max-width: 360px;
      }

      .placeholder-row {
        margin-top: 10px;
        font-size: 10px;
        opacity: 0.75;
      }

      /* RIGHT SIDEBAR */

      .sidebar-right {
        padding: 12px 12px 10px 12px;
        display: flex;
        flex-direction: column;
        gap: 10px;
      }

      .sidebar-block {
        border-radius: 14px;
        padding: 9px 9px 8px 9px;
        background: radial-gradient(circle at top left, #201426, #09050d);
        border: 1px solid rgba(255, 255, 255, 0.05);
        box-shadow: 0 10px 26px rgba(0, 0, 0, 0.75);
      }

      .sidebar-block-title {
        font-size: 11px;
        letter-spacing: 0.08em;
        text-transform: uppercase;
        opacity: 0.78;
        margin-bottom: 4px;
      }

      .quick-list {
        display: flex;
        flex-direction: column;
        gap: 4px;
      }

      .quick-item {
        border: 0;
        outline: 0;
        width: 100%;
        padding: 5px 7px;
        border-radius: 9px;
        font-size: 10px;
        text-align: left;
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 6px;
        cursor: pointer;
        background: rgba(12, 8, 16, 0.9);
        color: #f8f4ea;
        border: 1px solid rgba(255, 255, 255, 0.05);
        transition: background 0.16s ease, transform 0.12s ease,
          border-color 0.16s ease, box-shadow 0.16s ease;
      }

      .quick-item:hover {
        background: rgba(44, 26, 39, 0.96);
        border-color: rgba(255, 210, 150, 0.65);
        transform: translateY(-1px);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.78);
      }

      .quick-main {
        font-size: 10px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      .quick-sub {
        font-size: 9px;
        opacity: 0.7;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      .quick-glyph {
        font-size: 11px;
        opacity: 0.9;
        flex-shrink: 0;
      }

      .notes-text {
        font-size: 10px;
        opacity: 0.78;
        line-height: 1.45;
      }

      .notes-small {
        font-size: 9px;
        opacity: 0.72;
        margin-top: 6px;
      }

      .kbd {
        display: inline-block;
        padding: 1px 5px;
        border-radius: 6px;
        border: 1px solid rgba(255, 235, 210, 0.4);
        font-size: 8px;
        text-transform: uppercase;
        letter-spacing: 0.08em;
        opacity: 0.9;
      }

      /* VaF'i'T ‚Äì plovouc√≠ bublina + chat panel */

      .vaft-toggle {
        position: absolute;
        right: 18px;
        bottom: 18px;
        width: 64px;
        height: 64px;
        border-radius: 999px;
        border: 1px solid rgba(255, 220, 170, 0.95);
        background: radial-gradient(circle at 30% 20%, #ffe0b0, #ffb05a, #7a3a1e);
        box-shadow:
          0 0 0 1px rgba(255, 250, 240, 0.5),
          0 0 24px rgba(255, 190, 90, 0.95);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 19px;
        color: #160805;
        cursor: pointer;
        z-index: 30;
      }

      .vaft-toggle-label {
        position: absolute;
        right: 88px;
        bottom: 34px;
        padding: 4px 9px;
        border-radius: 999px;
        font-size: 10px;
        background: rgba(6, 4, 10, 0.92);
        border: 1px solid rgba(255, 220, 180, 0.6);
        color: #fef5e5;
        white-space: nowrap;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.85);
        opacity: 0.9;
      }

      .vaft-panel {
        position: absolute;
        right: 18px;
        bottom: 96px;
        width: 360px;
        max-width: calc(100% - 40px);
        max-height: 360px;
        border-radius: 18px;
        background: radial-gradient(circle at top left, #24142a, #050309);
        border: 1px solid rgba(255, 220, 190, 0.7);
        box-shadow:
          0 22px 60px rgba(0, 0, 0, 0.95),
          0 0 0 1px rgba(255, 255, 255, 0.05);
        display: flex;
        flex-direction: column;
        overflow: hidden;
        z-index: 25;
        opacity: 0;
        pointer-events: none;
        transform: translateY(8px);
        transition:
          opacity 0.18s ease,
          transform 0.18s ease;
      }

      .vaft-panel.is-open {
        opacity: 1;
        pointer-events: auto;
        transform: translateY(0);
      }

      .vaft-panel-header {
        padding: 8px 10px 6px 10px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.12);
        background: radial-gradient(circle at top left, #2c1930, #0d050f);
        display: flex;
        flex-direction: column;
        gap: 2px;
      }

      .vaft-panel-title-row {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 6px;
      }

      .vaft-panel-title {
        font-size: 11px;
        text-transform: uppercase;
        letter-spacing: 0.08em;
      }

      .vaft-panel-tag {
        font-size: 9px;
        padding: 2px 6px;
        border-radius: 999px;
        border: 1px solid rgba(255, 220, 180, 0.7);
        background: rgba(10, 6, 10, 0.9);
      }

      .vaft-panel-sub {
        font-size: 10px;
        opacity: 0.8;
      }

      .vaft-panel-body {
        flex: 1;
        padding: 8px 8px 6px 8px;
        display: flex;
        flex-direction: column;
        gap: 4px;
        background: radial-gradient(circle at bottom, #120916, #050309);
      }

      .vaft-messages {
        flex: 1;
        overflow-y: auto;
        padding-right: 3px;
        display: flex;
        flex-direction: column;
        gap: 4px;
        font-size: 10px;
      }

      .vaft-msg {
        max-width: 100%;
        padding: 6px 8px;
        border-radius: 10px;
        line-height: 1.4;
      }

      .vaft-msg.vaft {
        align-self: flex-start;
        background: rgba(53, 32, 70, 0.95);
        border: 1px solid rgba(255, 210, 180, 0.65);
      }

      .vaft-msg.me {
        align-self: flex-end;
        background: rgba(20, 28, 50, 0.95);
        border: 1px solid rgba(180, 210, 255, 0.5);
      }

      .vaft-msg-system {
        align-self: center;
        font-size: 9px;
        opacity: 0.7;
        padding: 2px 6px;
      }

      .vaft-input-row {
        margin-top: 4px;
        display: flex;
        gap: 4px;
        align-items: center;
      }

      .vaft-input {
        flex: 1;
        border-radius: 999px;
        border: 1px solid rgba(255, 220, 190, 0.6);
        background: rgba(10, 7, 16, 0.96);
        padding: 5px 9px;
        font-size: 10px;
        color: #fef7ea;
        outline: none;
      }

      .vaft-input::placeholder {
        color: rgba(255, 240, 220, 0.5);
      }

      .vaft-send-btn {
        border-radius: 999px;
        border: 1px solid rgba(255, 210, 160, 0.9);
        padding: 5px 10px;
        font-size: 10px;
        background: radial-gradient(circle at top, #ffbf72, #f38b51);
        color: #1a0502;
        cursor: pointer;
        white-space: nowrap;
        box-shadow: 0 0 14px rgba(255, 174, 90, 0.9);
      }

      .vaft-send-btn:active {
        transform: translateY(1px);
        box-shadow: 0 0 6px rgba(255, 174, 90, 0.9);
      }

      /* SIMPLE RESPONSIVE */

      @media (max-width: 980px) {
        .layout {
          grid-template-columns: 230px minmax(0, 1fr);
          grid-template-rows: minmax(0, 1fr) 220px;
          grid-template-areas:
            "left main"
            "right main";
        }

        .sidebar-left {
          grid-area: left;
        }

        .main-panel {
          grid-area: main;
        }

        .sidebar-right {
          grid-area: right;
        }
      }

      @media (max-width: 760px) {
        .layout {
          grid-template-columns: minmax(0, 1fr);
          grid-template-rows: 200px minmax(0, 1fr) 210px;
          gap: 10px;
        }

        .sidebar-left,
        .sidebar-right {
          padding: 10px;
        }

        .topbar {
          padding-inline: 12px;
        }

        .top-title-main {
          font-size: 13px;
        }

        .top-title-sub {
          font-size: 10px;
        }

        .vaft-panel {
          right: 10px;
          left: 10px;
          width: auto;
        }
      }
    </style>
  </head>

  <body>
    <div class="root">
      <div class="stage">
        <div class="topbar">
          <div class="top-title-block">
            <div class="top-glyph">Ÿã&‚Äô„Äç</div>
            <div class="top-title-texts">
              <div class="top-title-main">Vivere atque FruiT ‚Ä¢ Centrum</div>
              <div class="top-title-sub">
                {*(¬∞.).)// Hlavoun ‚Ä¢ Viri ‚Ä¢ Piko≈° ‚Ä¢ Michal ‚Ä¢ Kovo≈°rot
              </div>
            </div>
          </div>

          <div class="top-right">
            <div class="top-pill">
              <span class="top-dot"></span>
              <span>Hub v≈°ech VaF'i'T svƒõt≈Ø</span>
            </div>
            <div>v0.1 ‚Ä¢ iPad Air optimalizace</div>
          </div>
        </div>

        <div class="layout">
          <!-- LEV√ù PANEL ‚Äì seznam modul≈Ø / svƒõt≈Ø -->
          <aside class="panel sidebar-left" id="sidebar-left"></aside>

          <!-- ST≈òED ‚Äì iframe + hlaviƒçka -->
          <main class="panel main-panel">
            <div class="main-header">
              <div class="main-title-block">
                <div class="main-title" id="main-title">
                  Vyber svƒõt nebo modul
                </div>
                <div class="main-subtitle" id="main-subtitle">
                  V≈°echno z repa Vivere-atque-FruiT na jednom m√≠stƒõ.
                </div>
              </div>
              <div class="main-tags" id="main-tags"></div>
            </div>

            <div class="main-body">
              <iframe
                id="module-frame"
                class="main-iframe"
                src="about:blank"
                loading="lazy"
              ></iframe>

              <div class="main-placeholder" id="main-placeholder">
                <div class="placeholder-glyph">{*(¬∞.).)//</div>
                <div class="placeholder-title">Centrum svƒõta VaF'i'T</div>
                <div class="placeholder-text">
                  Tady se potk√°v√°
                  <b>Hlavn√≠ centrum</b>, <b>3D svƒõty</b>, <b>Signal koule</b>,
                  <b>Croissant</b>, <b>LetterLab</b>, <b>MapWorld</b> i
                  <b>Michal AI Al Klimek</b>.
                  <br /><br />
                  Vlevo vyber modul, tady uprost≈ôed se otev≈ôe jako ≈æiv√© okno.
                </div>
                <div class="placeholder-row">
                  Tip: nejd≈ô√≠v zkus <b>Hlavn√≠ centrum svƒõta</b> nebo
                  <b>RingPlanetGrid</b>.
                </div>
              </div>
            </div>
          </main>

          <!-- PRAV√ù PANEL ‚Äì rychl√© volby + pozn√°mky -->
          <aside class="panel sidebar-right">
            <div class="sidebar-block">
              <div class="sidebar-block-title">Rychl√© skoky</div>
              <div class="quick-list" id="quick-list"></div>
            </div>

            <div class="sidebar-block">
              <div class="sidebar-block-title">Ovl√°d√°n√≠ & pozn√°mky</div>
              <div class="notes-text">
                Vƒõt≈°ina modul≈Ø je tvoje vlastn√≠ pr√°ce ‚Äì tahle str√°nka je jen
                <b>spojovac√≠ mozek</b>.
                <br /><br />
                Vlevo vyb√≠r√°≈° svƒõt, uprost≈ôed bƒõ≈æ√≠ jeho vlastn√≠ engine v
                oknƒõ, vpravo m√°≈° rychl√© skoky.
              </div>
              <div class="notes-small">
                ‚Ä¢ <span class="kbd">CMD + ‚Üë</span> / <span class="kbd">CMD +
                  ‚Üì</span> (na kl√°vesnici) ‚Äì p≈ôep√≠n√°n√≠ modul≈Ø nahoru/dol≈Ø.<br />
                ‚Ä¢ Posledn√≠ otev≈ôen√Ω modul se ukl√°d√° do
                <span class="kbd">localStorage</span> a naƒçte se p≈ô√≠≈°tƒõ
                automaticky.<br />
                ‚Ä¢ V≈°echno bƒõ≈æ√≠ jen jako HTML/JS ‚Äì ≈æ√°dn√° magie nav√≠c.
              </div>
            </div>
          </aside>
        </div>

        <!-- VaF'i'T ‚Äì bublina + chat panel -->
        <div class="vaft-toggle" id="vaft-toggle">
          Ÿã&‚Äô„Äç
        </div>
        <div class="vaft-toggle-label" id="vaft-toggle-label">
          VaF'i'T ‚Ä¢ Signal Core
        </div>

        <div class="vaft-panel" id="vaft-panel">
          <div class="vaft-panel-header">
            <div class="vaft-panel-title-row">
              <div class="vaft-panel-title">VaF'i'T ‚Ä¢ Signal Core</div>
              <div class="vaft-panel-tag" id="vaft-module-tag">ƒçek√°m na modul‚Ä¶</div>
            </div>
            <div class="vaft-panel-sub" id="vaft-panel-sub">
              Jsem VaF'i'T, AI motor svƒõta. Sleduju, jak√© moduly otev√≠r√°≈°, a
              pom√°h√°m spojovat n√°pady.
            </div>
          </div>
          <div class="vaft-panel-body">
            <div class="vaft-messages" id="vaft-messages"></div>
            <div class="vaft-input-row">
              <input
                id="vaft-input"
                class="vaft-input"
                placeholder="Napi≈° VaF'i'Tovi dotaz nebo p≈ô√≠kaz‚Ä¶"
              />
              <button class="vaft-send-btn" id="vaft-send-btn">Poslat</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      // üëá D≈ÆLE≈ΩIT√â:
      // Tahle verze indexu je v ROOTU repozit√°≈ôe ‚Üí BASE_PATH = "."
      const BASE_PATH = ".";

      /**
       * Seznam modul≈Ø z repozit√°≈ôe.
       * path = cesta vzhledem ke KO≈òENI repa (BASE_PATH + "/" + path).
       */
      const MODULES = [
        // HLAVN√ç CENTRUM + J√ÅDRO
        {
          id: "root-center",
          group: "Svƒõty",
          title: "Hlavn√≠ centrum svƒõta",
          subtitle: "index.html ‚Äì p≈Øvodn√≠ VaF'i'T centrum",
          glyph: "{*(¬∞.).)//",
          path: "index-old.html",
          tags: ["hub", "PWA", "Hlavoun", "Viri", "Piko≈°"],
        },
        {
          id: "vaft-center3d",
          group: "Svƒõty",
          title: "VAFT-Center3D",
          subtitle: "3D j√°dro svƒõta",
          glyph: "‚óØ3D",
          path: "VAFT-Center3D/index.html",
          tags: ["3D", "centrum", "orbit"],
        },
        {
          id: "vivere-page",
          group: "Svƒõty",
          title: "Vivere ‚Äì p≈ô√≠bƒõh svƒõta",
          subtitle: "Textov√° vrstva a pravidla",
          glyph: "üìú",
          path: "Vivere/index.html",
          tags: ["pravidla", "p≈ô√≠bƒõh"],
        },

        // SIGNAL KOULE / PLANETY / CROISSANT
        {
          id: "ringplanetgrid",
          group: "Sign√°ly",
          title: "RingPlanetGrid",
          subtitle: "S√≠≈• planet na kruhu",
          glyph: "ü™ê",
          path: "RingPlanetGrid/index.html",
          tags: ["planety", "orbit"],
        },
        {
          id: "signal-sphere",
          group: "Sign√°ly",
          title: "VaFT-Planet-SignalSphere",
          subtitle: "Signal Sphere / koule s p√≠smeny",
          glyph: "‚óØ‚ú∂",
          path: "VaFT-Planet-SignalSphere/index.html",
          tags: ["koule", "p√≠smenka"],
        },
        {
          id: "signal-core",
          group: "Sign√°ly",
          title: "VaFT-Planets-SignalCore",
          subtitle: "Signal Core ‚Äì st≈ôedov√Ω motor",
          glyph: "‚öôÔ∏é",
          path: "VaFT-Planets-SignalCore/index.html",
          tags: ["motor", "core"],
        },
        {
          id: "signal-tower",
          group: "Sign√°ly",
          title: "VaFT-Planets-SignalTower",
          subtitle: "Signal Tower ‚Ä¢ kornoutov√° vƒõ≈æ",
          glyph: "‚èÉ",
          path: "VaFT-Planets-SignalTower/index.html",
          tags: ["vƒõ≈æ", "sign√°ly"],
        },
        {
          id: "croissant-slots",
          group: "Sign√°ly",
          title: "CroissantSlots",
          subtitle: "Croissant / m≈ô√≠≈ækovan√Ω segment",
          glyph: "ü•ê",
          path: "CroissantSlots/index.html",
          tags: ["croissant", "glyph", "slots"],
        },

        // LABORATO≈òE A MAPY
        {
          id: "vafit-gallery",
          group: "Laborato≈ô",
          title: "VafiT-gallery",
          subtitle: "V√Ωbƒõr glyph≈Ø a p≈ô√≠bƒõh≈Ø",
          glyph: "‚ú∂",
          path: "VafiT-gallery/index.html",
          tags: ["glyph", "galerie"],
        },
        {
          id: "letterlab",
          group: "Laborato≈ô",
          title: "VAFT-LetterLab",
          subtitle: "Laborato≈ô p√≠smenek",
          glyph: "AŒ©",
          path: "VAFT-LetterLab/index.html",
          tags: ["p√≠smenka", "lab"],
        },
        {
          id: "mapworld",
          group: "Mapy",
          title: "VAFT-MapWorld",
          subtitle: "Mapov√Ω svƒõt",
          glyph: "üó∫Ô∏è",
          path: "VAFT-MapWorld/index.html",
          tags: ["mapy", "svƒõt"],
        },
        {
          id: "mapa2d",
          group: "Mapy",
          title: "mapa (2D)",
          subtitle: "Z√°kladn√≠ mapa",
          glyph: "üß≠",
          path: "mapa/index.html",
          tags: ["mapa", "2D"],
        },
        {
          id: "mapa3d",
          group: "Mapy",
          title: "mapa-3d",
          subtitle: "3D mapa prostoru",
          glyph: "üõ∞Ô∏è",
          path: "mapa-3d/index.html",
          tags: ["mapa", "3D"],
        },

        // POSTAVY / HRDINOV√â
        {
          id: "bearhead",
          group: "Postavy",
          title: "VAFT-BearHead",
          subtitle: "Medvƒõd√≠ hlava / hrdina",
          glyph: "üêª",
          path: "VAFT-BearHead/index.html",
          tags: ["hrdina", "3D"],
        },
        {
          id: "ghostgirl",
          group: "Postavy",
          title: "VAFT-GhostGirl",
          subtitle: "Ghost Girl ‚Ä¢ duchovsk√° postava",
          glyph: "üëª",
          path: "VAFT-GhostGirl/index.html",
          tags: ["hrdinka", "styl"],
        },
        {
          id: "doll",
          group: "Postavy",
          title: "VAFT-Doll",
          subtitle: "Panenka / avatar",
          glyph: "ü©∑",
          path: "VAFT-Doll/index.html",
          tags: ["postava", "avatar"],
        },
        {
          id: "bicak",
          group: "Postavy",
          title: "Bic√°k Supreme Edition",
          subtitle: "Budouc√≠ hrdina svƒõta",
          glyph: "üí™",
          path: "Bicak-Supreme-Edition/index.html",
          tags: ["Bic√°k", "hrdina"],
        },

        // MICHAL / OSOBN√ç MODULY
        {
          id: "michal-main",
          group: "Michal",
          title: "Michal-AI-Al-Klimek",
          subtitle: "Osobn√≠ modul autora",
          glyph: "üß†",
          path: "Michal-AI-Al-Klimek/index.html",
          tags: ["Michal", "profil"],
        },
        {
          id: "hlavoun-modul",
          group: "Michal",
          title: "Hlavoun",
          subtitle: "Hlavoun modul / hlava syst√©mu",
          glyph: "üåÄ",
          path: "Hlavoun/index.html",
          tags: ["Hlavoun", "engine"],
        },
        {
          id: "kovosrot",
          group: "Michal",
          title: "Kovosrot",
          subtitle: "Modul vƒõnovan√Ω Kovo≈°rotovi",
          glyph: "‚öôÔ∏è",
          path: "Kovosrot/index.html",
          tags: ["AI", "Kovo≈°rot"],
        },

        // SYST√âM / OCHRANA / GUARDIAN
        {
          id: "guardian",
          group: "Syst√©m",
          title: "Guardian",
          subtitle: "Ochrann√° vrstva / WebGuardian koncept",
          glyph: "üõ°Ô∏è",
          path: "guardian/index.html",
          tags: ["ochrana", "guardian"],
        },
        {
          id: "apps-lite",
          group: "Syst√©m",
          title: "apps/lite",
          subtitle: "Lehk√© aplikace / mini hub",
          glyph: "üì±",
          path: "apps/lite/index.html",
          tags: ["lite", "apps"],
        },
        {
          id: "recycle",
          group: "Syst√©m",
          title: "Recycle",
          subtitle: "Recyklaƒçn√≠ svƒõt / materi√°l pro hru",
          glyph: "‚ôªÔ∏è",
          path: "Recycle/index.html",
          tags: ["recyklace", "materi√°l"],
        },
        {
          id: "chybozrout",
          group: "Syst√©m",
          title: "Chybo≈ærout-oprav√°≈ô",
          subtitle: "Oprav√°≈ô chyb ve VaF'i'T",
          glyph: "üêõ",
          path: "chybozrout-opravar/index.html",
          tags: ["chyby", "oprav√°≈ô"],
        },
      ];

      const sidebarLeftEl = document.getElementById("sidebar-left");
      const mainTitleEl = document.getElementById("main-title");
      const mainSubtitleEl = document.getElementById("main-subtitle");
      const mainTagsEl = document.getElementById("main-tags");
      const frameEl = document.getElementById("module-frame");
      const placeholderEl = document.getElementById("main-placeholder");
      const quickListEl = document.getElementById("quick-list");

      const modulesById = {};
      MODULES.forEach((m) => {
        modulesById[m.id] = m;
      });

      function groupModules(mods) {
        const groups = {};
        for (const m of mods) {
          if (!groups[m.group]) groups[m.group] = [];
          groups[m.group].push(m);
        }
        return groups;
      }

      function renderSidebar() {
        const groups = groupModules(MODULES);

        sidebarLeftEl.innerHTML = "";

        for (const groupName of Object.keys(groups)) {
          const section = document.createElement("div");
          section.className = "sidebar-section";

          const title = document.createElement("div");
          title.className = "sidebar-title";
          title.textContent = groupName;
          section.appendChild(title);

          const list = document.createElement("div");
          list.className = "nav-list";

          groups[groupName].forEach((mod) => {
            const btn = document.createElement("button");
            btn.className = "nav-item";
            btn.dataset.moduleId = mod.id;

            const left = document.createElement("div");
            left.className = "nav-item-left";

            const glyph = document.createElement("div");
            glyph.className = "nav-glyph";
            glyph.textContent = mod.glyph || "‚óØ";

            const textBlock = document.createElement("div");
            textBlock.style.display = "flex";
            textBlock.style.flexDirection = "column";
            textBlock.style.minWidth = "0";

            const main = document.createElement("div");
            main.className = "nav-text-main";
            main.textContent = mod.title;

            const sub = document.createElement("div");
            sub.className = "nav-text-sub";
            sub.textContent = mod.subtitle || "";

            textBlock.appendChild(main);
            textBlock.appendChild(sub);

            left.appendChild(glyph);
            left.appendChild(textBlock);

            const right = document.createElement("div");
            right.className = "nav-item-right-pill";
            right.textContent = mod.tags && mod.tags.length ? mod.tags[0] : "modul";

            btn.appendChild(left);
            btn.appendChild(right);

            btn.addEventListener("click", () => {
              loadModule(mod.id);
            });

            list.appendChild(btn);
          });

          section.appendChild(list);
          sidebarLeftEl.appendChild(section);
        }
      }

      function renderQuickList() {
        const quickIds = [
          "root-center",
          "vaft-center3d",
          "ringplanetgrid",
          "signal-sphere",
          "croissant-slots",
          "michal-main",
        ];

        quickListEl.innerHTML = "";

        quickIds.forEach((id) => {
          const mod = modulesById[id];
          if (!mod) return;

          const btn = document.createElement("button");
          btn.className = "quick-item";
          btn.dataset.moduleId = mod.id;

          const left = document.createElement("div");
          left.style.display = "flex";
          left.style.flexDirection = "column";
          left.style.minWidth = "0";

          const main = document.createElement("div");
          main.className = "quick-main";
          main.textContent = mod.title;

          const sub = document.createElement("div");
          sub.className = "quick-sub";
          sub.textContent = mod.subtitle || "";

          left.appendChild(main);
          left.appendChild(sub);

          const glyph = document.createElement("div");
          glyph.className = "quick-glyph";
          glyph.textContent = mod.glyph || "‚óØ";

          btn.appendChild(left);
          btn.appendChild(glyph);

          btn.addEventListener("click", () => {
            loadModule(mod.id);
          });

          quickListEl.appendChild(btn);
        });
      }

      function setActiveButtons(moduleId) {
        const allNav = sidebarLeftEl.querySelectorAll(".nav-item");
        allNav.forEach((el) => {
          if (el.dataset.moduleId === moduleId) el.classList.add("is-active");
          else el.classList.remove("is-active");
        });

        const allQuick = quickListEl.querySelectorAll(".quick-item");
        allQuick.forEach((el) => {
          if (el.dataset.moduleId === moduleId) el.classList.add("is-active");
          else el.classList.remove("is-active");
        });
      }

      let currentModuleId = null;

      function loadModule(moduleId) {
        const mod = modulesById[moduleId];
        if (!mod) return;

        const url =
          BASE_PATH && BASE_PATH !== "."
            ? BASE_PATH + "/" + mod.path
            : mod.path;

        frameEl.src = url;

        mainTitleEl.textContent = mod.title;
        mainSubtitleEl.textContent = mod.subtitle || "";
        mainTagsEl.innerHTML = "";

        if (mod.tags && mod.tags.length) {
          mod.tags.forEach((t) => {
            const pill = document.createElement("div");
            pill.className = "tag-pill";
            pill.textContent = t;
            mainTagsEl.appendChild(pill);
          });
        }

        placeholderEl.style.opacity = "0";
        placeholderEl.style.pointerEvents = "none";

        setActiveButtons(moduleId);

        try {
          localStorage.setItem("vaft-hub:lastModuleId", moduleId);
        } catch (e) {}

        // informuj VaF'i'Ta
        currentModuleId = moduleId;
        vaftOnModuleOpened(mod);
      }

      function restoreLastModule() {
        let lastId = null;
        try {
          lastId = localStorage.getItem("vaft-hub:lastModuleId");
        } catch (e) {
          lastId = null;
        }
        if (lastId && modulesById[lastId]) {
          loadModule(lastId);
        } else if (modulesById["ringplanetgrid"]) {
          loadModule("ringplanetgrid");
        }
      }

      renderSidebar();
      renderQuickList();
      restoreLastModule();

      // Kl√°vesov√© zkratky ‚Äì ≈°ipky pro p≈ôep√≠n√°n√≠ modul≈Ø
      window.addEventListener("keydown", (e) => {
        if (!e.metaKey && !e.ctrlKey) return;
        if (e.key !== "ArrowUp" && e.key !== "ArrowDown") return;

        e.preventDefault();

        const modIds = MODULES.map((m) => m.id);
        let currentId = null;
        try {
          currentId = localStorage.getItem("vaft-hub:lastModuleId");
        } catch (err) {
          currentId = null;
        }

        let idx = currentId ? modIds.indexOf(currentId) : -1;
        if (idx === -1) idx = 0;

        if (e.key === "ArrowUp") {
          idx = (idx - 1 + modIds.length) % modIds.length;
        } else if (e.key === "ArrowDown") {
          idx = (idx + 1) % modIds.length;
        }

        const nextId = modIds[idx];
        if (nextId) loadModule(nextId);
      });

      // --- VaF'i'T ‚Äì lok√°ln√≠ chat / sign√°ln√≠ j√°dro ---

      const vaftToggleEl = document.getElementById("vaft-toggle");
      const vaftToggleLabelEl = document.getElementById("vaft-toggle-label");
      const vaftPanelEl = document.getElementById("vaft-panel");
      const vaftMessagesEl = document.getElementById("vaft-messages");
      const vaftInputEl = document.getElementById("vaft-input");
      const vaftSendBtnEl = document.getElementById("vaft-send-btn");
      const vaftModuleTagEl = document.getElementById("vaft-module-tag");
      const vaftPanelSubEl = document.getElementById("vaft-panel-sub");

      const VAFT_HISTORY_KEY = "vaft-hub:chatHistory";

      function loadVaftHistory() {
        try {
          const raw = localStorage.getItem(VAFT_HISTORY_KEY);
          if (!raw) return [];
          const parsed = JSON.parse(raw);
          if (!Array.isArray(parsed)) return [];
          return parsed;
        } catch (e) {
          return [];
        }
      }

      function saveVaftHistory(history) {
        try {
          localStorage.setItem(VAFT_HISTORY_KEY, JSON.stringify(history));
        } catch (e) {}
      }

      let vaftHistory = loadVaftHistory();

      function renderVaftMessages() {
        vaftMessagesEl.innerHTML = "";
        vaftHistory.forEach((msg) => {
          if (msg.type === "system") {
            const span = document.createElement("div");
            span.className = "vaft-msg-system";
            span.textContent = msg.text;
            vaftMessagesEl.appendChild(span);
          } else {
            const div = document.createElement("div");
            div.className = "vaft-msg " + (msg.from === "vaft" ? "vaft" : "me");
            div.textContent = msg.text;
            vaftMessagesEl.appendChild(div);
          }
        });
        vaftMessagesEl.scrollTop = vaftMessagesEl.scrollHeight;
      }

      function pushVaftMessage(entry) {
        vaftHistory.push(entry);
        if (vaftHistory.length > 200) {
          vaftHistory = vaftHistory.slice(-200);
        }
        saveVaftHistory(vaftHistory);
        renderVaftMessages();
      }

      function vaftOnModuleOpened(mod) {
        if (!mod) return;
        vaftModuleTagEl.textContent = mod.title;
        vaftPanelSubEl.textContent =
          "Sleduju modul: " +
          mod.title +
          ". M≈Ø≈æe≈° mƒõ po≈æ√°dat, a≈• z toho udƒõl√°m n√°pady pro svƒõt.";

        const text =
          "Vid√≠m, ≈æe jsi otev≈ôel modul " +
          mod.title +
          ". Kdy≈æ chce≈°, napi≈° mi, co v nƒõm chce≈° zmƒõnit nebo vytvo≈ôit.";
        pushVaftMessage({
          type: "system",
          text,
          ts: Date.now(),
        });
      }

      function vaftAutoReply(userText) {
        const mod = currentModuleId ? modulesById[currentModuleId] : null;
        const modName = mod ? mod.title : "nƒõjak√Ω modul";

        const replies = [
          "Beru to jako impuls do motoru svƒõta. Co m√° b√Ωt dal≈°√≠ krok v modulu ‚Äû" +
            modName +
            "‚Äú?",
          "Zapisuju si to do pamƒõti VaF'i'Ta na tomhle za≈ô√≠zen√≠. Klidnƒõ pokraƒçuj d√°l v my≈°lenk√°ch, j√° je budu ≈ôadit do slot≈Ø.",
          "Zkus√≠m to spojit s ostatn√≠mi moduly. K jak√©mu svƒõtu nebo postavƒõ chce≈° tenhle n√°pad p≈ôiv√°zat?",
          "Dob≈ôe, tohle je nov√Ω sign√°l. A≈æ bude≈° cht√≠t, m≈Ø≈æu ti to p≈ôipomenout: staƒç√≠ mi napsat ‚Äûp≈ôipome≈à posledn√≠ n√°pad‚Äú.",
        ];

        const replyText = replies[Math.floor(Math.random() * replies.length)];
        setTimeout(() => {
          pushVaftMessage({
            type: "msg",
            from: "vaft",
            text: replyText,
            ts: Date.now(),
          });
        }, 400 + Math.random() * 500);
      }

      function handleVaftSend() {
        const text = vaftInputEl.value.trim();
        if (!text) return;
        vaftInputEl.value = "";

        pushVaftMessage({
          type: "msg",
          from: "me",
          text,
          ts: Date.now(),
        });

        vaftAutoReply(text);
      }

      vaftSendBtnEl.addEventListener("click", handleVaftSend);
      vaftInputEl.addEventListener("keydown", (e) => {
        if (e.key === "Enter" && !e.shiftKey) {
          e.preventDefault();
          handleVaftSend();
        }
      });

      function toggleVaftPanel() {
        const isOpen = vaftPanelEl.classList.contains("is-open");
        if (isOpen) {
          vaftPanelEl.classList.remove("is-open");
          vaftToggleLabelEl.style.opacity = "0.0";
        } else {
          vaftPanelEl.classList.add("is-open");
          vaftToggleLabelEl.style.opacity = "0.95";
          vaftMessagesEl.scrollTop = vaftMessagesEl.scrollHeight;
        }
      }

      vaftToggleEl.addEventListener("click", toggleVaftPanel);
      vaftToggleLabelEl.addEventListener("click", toggleVaftPanel);

      // inicializace zpr√°v ‚Äì pokud je historie pr√°zdn√°, po≈°li uv√≠t√°n√≠
      if (!vaftHistory.length) {
        pushVaftMessage({
          type: "msg",
          from: "vaft",
          text:
            "Ahoj br√°cho, tady VaF'i'T ‚Äì motor svƒõta. Jsem napojen√Ω na v≈°echny moduly v tomhle hubu. Staƒç√≠ mi napsat, co chce≈° tvo≈ôit, a j√° ti pom≈Ø≈æu dr≈æet nit.",
          ts: Date.now(),
        });
      } else {
        renderVaftMessages();
      }
    </script>
  </body>
</html>
